!function(e){var t={};function n(o){if(t[o])return t[o].exports;var l=t[o]={i:o,l:!1,exports:{}};return e[o].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(o,l,function(t){return e[t]}.bind(null,l));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=o(n(2));(()=>{const e=document.createElement("template");e.innerHTML="\n    <div id='sac-app-redesign_container'></div>\n    ";class t extends HTMLElement{constructor(){super(),this._shadowRoot=this.attachShadow({mode:"open"}),this._shadowRoot.appendChild(e.content.cloneNode(!0)),this.initComponents()}initComponents(){new l.default({target:this._shadowRoot.getElementById("sac-app-redesign_container")})}}customElements.define("sac-app-redesign",t)})()},,function(e,t,n){"use strict";function o(){}n.r(t);function l(e){return e()}function r(){return Object.create(null)}function c(e){e.forEach(l)}function a(e){return"function"==typeof e}function u(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}new Set;function s(e,t){e.appendChild(t)}function i(e,t,n){e.insertBefore(t,n||null)}function d(e){e.parentNode.removeChild(e)}function f(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function g(e){return document.createElement(e)}function p(e){return document.createTextNode(e)}function b(){return p(" ")}function h(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function m(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function v(e,t){t=""+t,e.data!==t&&(e.data=t)}function _(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function y(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function C(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}let w;function k(e){w=e}const x=[],$=[],E=[],S=[],O=Promise.resolve();let M=!1;function T(){M||(M=!0,O.then(B))}function j(e){E.push(e)}const N=new Set;function B(){do{for(;x.length;){const e=x.shift();k(e),P(e.$$)}for(;$.length;)$.pop()();for(let e=0;e<E.length;e+=1){const t=E[e];N.has(t)||(N.add(t),t())}E.length=0}while(x.length);for(;S.length;)S.pop()();M=!1,N.clear()}function P(e){if(null!==e.fragment){e.update(),c(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(j)}}const I=new Set;function L(e,t){e&&e.i&&(I.delete(e),e.i(t))}"undefined"!=typeof window?window:global;new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]);let q;function A(e,t){const n=e.$$;null!==n.fragment&&(c(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function H(e,t,n,u,s,i,d=[-1]){const f=w;k(e);const g=t.props||{},p=e.$$={fragment:null,ctx:null,props:i,update:o,not_equal:s,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:r(),dirty:d};let b=!1;var h;p.ctx=n?n(e,g,(t,n,...o)=>{const l=o.length?o[0]:n;return p.ctx&&s(p.ctx[t],p.ctx[t]=l)&&(p.bound[t]&&p.bound[t](l),b&&function(e,t){-1===e.$$.dirty[0]&&(x.push(e),T(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n}):[],p.update(),b=!0,c(p.before_update),p.fragment=!!u&&u(p.ctx),t.target&&(t.hydrate?p.fragment&&p.fragment.l((h=t.target,Array.from(h.childNodes))):p.fragment&&p.fragment.c(),t.intro&&L(e.$$.fragment),function(e,t,n){const{fragment:o,on_mount:r,on_destroy:u,after_update:s}=e.$$;o&&o.m(t,n),j(()=>{const t=r.map(l).filter(a);u?u.push(...t):c(t),e.$$.on_mount=[]}),s.forEach(j)}(e,t.target,t.anchor),B()),k(f)}"function"==typeof HTMLElement&&(q=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}$destroy(){A(this,1),this.$destroy=o}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}});class U{$destroy(){A(this,1),this.$destroy=o}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function R(e,t,n){const o=e.slice();return o[21]=t[n],o}function D(e,t,n){const o=e.slice();return o[21]=t[n],o}function W(e){let t,n,l,r=e[21].name+"";return{c(){t=g("option"),n=p(r),t.__value=l=e[21].value,t.value=t.__value,_(t,"background",e[21].value),_(t,"color",e[21].dropColor)},m(e,o){i(e,t,o),s(t,n)},p:o,d(e){e&&d(t)}}}function X(e){let t,n,l,r=e[21].name+"";return{c(){t=g("option"),n=p(r),t.__value=l=e[21].value,t.value=t.__value,_(t,"background",e[21].value),_(t,"color",e[21].dropColor)},m(e,o){i(e,t,o),s(t,n)},p:o,d(e){e&&d(t)}}}function Y(e){let t,n,l,r,a,u,_,C,w,k,x,$,E,S,O,M,T,N,B,P,I,L,q,A,H,U,Y,z,F,G,J,K,Q,V,Z,ee,te,ne,oe,le,re,ce,ae=e[4].x+"",ue=e[4].y+"",se=e[5],ie=[];for(let t=0;t<se.length;t+=1)ie[t]=W(D(e,se,t));let de=e[5],fe=[];for(let t=0;t<de.length;t+=1)fe[t]=X(R(e,de,t));return{c(){t=g("div"),n=p("Clicked at "),l=p(ae),r=p(" x "),a=p(ue),u=p(".\n\n"),_=g("select"),C=g("option"),C.textContent="row 1 / col. 1",w=g("option"),w.textContent="row 1 / col. 2",k=g("option"),k.textContent="row 2 / col. 1",x=g("option"),x.textContent="row 2 / col. 2",$=g("option"),$.textContent="upper row",E=g("option"),E.textContent="lower row",S=g("option"),S.textContent="left column",O=g("option"),O.textContent="right column",M=g("option"),M.textContent="complete chart",T=b(),N=g("select");for(let e=0;e<ie.length;e+=1)ie[e].c();B=b(),P=g("select");for(let e=0;e<fe.length;e+=1)fe[e].c();I=b(),L=g("div"),q=g("p"),q.textContent="Modify color of",A=b(),H=g("label"),U=g("input"),z=p("\n\tbackground"),F=b(),G=g("label"),J=g("input"),Q=p("\n\ttext"),V=b(),Z=g("button"),Z.textContent="Change background",ee=b(),te=g("button"),te.textContent="Change text color",ne=b(),oe=g("button"),oe.textContent="I",le=b(),re=g("button"),re.textContent="B",C.__value="1",C.value=C.__value,w.__value="2",w.value=w.__value,k.__value="3",k.value=k.__value,x.__value="4",x.value=x.__value,$.__value="5",$.value=$.__value,E.__value="6",E.value=E.__value,S.__value="7",S.value=S.__value,O.__value="8",O.value=O.__value,M.__value="9",M.value=M.__value,void 0===e[2]&&j(()=>e[15].call(_)),void 0===e[0]&&j(()=>e[16].call(N)),void 0===e[1]&&j(()=>e[17].call(P)),m(U,"type","radio"),m(U,"name","scopeSelect"),U.__value=Y=0,U.value=U.__value,U.checked="checked",e[19][0].push(U),m(J,"type","radio"),m(J,"name","scopeSelect"),J.__value=K=1,J.value=J.__value,e[19][0].push(J)},m(o,c){i(o,t,c),s(t,n),s(t,l),s(t,r),s(t,a),s(t,u),s(t,_),s(_,C),s(_,w),s(_,k),s(_,x),s(_,$),s(_,E),s(_,S),s(_,O),s(_,M),y(_,e[2]),s(t,T),s(t,N);for(let e=0;e<ie.length;e+=1)ie[e].m(N,null);y(N,e[0]),s(t,B),s(t,P);for(let e=0;e<fe.length;e+=1)fe[e].m(P,null);y(P,e[1]),s(t,I),s(t,L),s(L,q),s(L,A),s(L,H),s(H,U),U.checked=U.__value===e[3],s(H,z),s(L,F),s(L,G),s(G,J),J.checked=J.__value===e[3],s(G,Q),s(t,V),s(t,Z),s(t,ee),s(t,te),s(t,ne),s(t,oe),s(t,le),s(t,re),ce=[h(_,"change",e[15]),h(N,"change",e[16]),h(P,"change",e[17]),h(U,"change",e[18]),h(J,"change",e[20]),h(Z,"click",e[6]),h(te,"click",e[7]),h(oe,"click",e[8](1)),h(re,"click",e[8](2)),h(t,"click",e[9])]},p(e,[t]){if(16&t&&ae!==(ae=e[4].x+"")&&v(l,ae),16&t&&ue!==(ue=e[4].y+"")&&v(a,ue),4&t&&y(_,e[2]),32&t){let n;for(se=e[5],n=0;n<se.length;n+=1){const o=D(e,se,n);ie[n]?ie[n].p(o,t):(ie[n]=W(o),ie[n].c(),ie[n].m(N,null))}for(;n<ie.length;n+=1)ie[n].d(1);ie.length=se.length}if(1&t&&y(N,e[0]),32&t){let n;for(de=e[5],n=0;n<de.length;n+=1){const o=R(e,de,n);fe[n]?fe[n].p(o,t):(fe[n]=X(o),fe[n].c(),fe[n].m(P,null))}for(;n<fe.length;n+=1)fe[n].d(1);fe.length=de.length}2&t&&y(P,e[1]),8&t&&(U.checked=U.__value===e[3]),8&t&&(J.checked=J.__value===e[3])},i:o,o:o,d(n){n&&d(t),f(ie,n),f(fe,n),e[19][0].splice(e[19][0].indexOf(U),1),e[19][0].splice(e[19][0].indexOf(J),1),c(ce)}}}function z(e,t){return"italic"!=e.fontStyle&&1==t?"italic":"italic"==e.fontStyle&&1==t?"":"bold"!=e.fontWeight&&2==t?"bold":"normal"}function F(e,t,n){let o="rgb(255, 255, 255)",l="rgb(0, 0, 0)";const r=[],c=[];let a=[{value:"rgb(255, 255, 255)",name:"white",dropColor:"rgb(0, 0, 0)"},{value:"rgb(211, 211, 211)",name:"light grey",dropColor:"rgb(0, 0, 0)"},{value:"rgb(128, 128, 128)",name:"grey",dropColor:"rgb(0, 0, 0)"},{value:"rgb(48, 48, 48)",name:"dark grey",dropColor:"rgb(255, 255, 255)"},{value:"rgb(0, 0, 0)",name:"black",dropColor:"rgb(255, 255, 255)"},{value:"rgb(255, 255, 0)",name:"yellow",dropColor:"rgb(0, 0, 0)"},{value:"rgb(240, 230, 140)",name:"khaki",dropColor:"rgb(0, 0, 0)"},{value:"rgb(189, 183, 107)",name:"dark khaki",dropColor:"rgb(0, 0, 0)"},{value:"rgb(255, 165, 0)",name:"orange",dropColor:"rgb(0, 0, 0)"},{value:"rgb(255, 69, 0)",name:"orange red",dropColor:"rgb(0, 0, 0)"},{value:"rgb(255, 0, 0)",name:"red",dropColor:"rgb(0, 0, 0)"},{value:"rgb(178, 34, 34)",name:"fire brick",dropColor:"rgb(255, 255, 255)"},{value:"rgb(240, 128, 128)",name:"light coral",dropColor:"rgb(0, 0, 0)"},{value:"rgb(148, 0, 211)",name:"dark violet",dropColor:"rgb(0, 0, 0)"},{value:"rgb(0, 0, 255)",name:"blue",dropColor:"rgb(255, 255, 255)"},{value:"rgb(30, 144, 255)",name:"dodger blue",dropColor:"rgb(0, 0, 0)"},{value:"rgb(0, 255, 127)",name:"spring green",dropColor:"rgb(0, 0, 0)"},{value:"rgb(50, 205, 50)",name:"lime green",dropColor:"rgb(0, 0, 0)"},{value:"rgb(0, 128, 0)",name:"green",dropColor:"rgb(0, 0, 0)"}],u="1",s=1;function i(e,t){1===t?0==s?e.style.background=o:e.style.color=o:2===t?e.style.fontStyle="italic":3===t&&(e.style.fontStyle="bold")}function d(e){const t=document.getElementsByClassName("sapEpmUiControlCrosstabTableInner")[0];for(let n=0;n<t.rows.length;n++){r.push([]),c.push([]);for(let l=0;l<t.rows[n].cells.length;l++)null!=e.target.closest("tr")&&e.target.closest("tr").dataset.row==n&&null!=e.target.closest("td")&&e.target.closest("td").dataset.col==l&&(r[n][l]=t.rows[n].cells[l].style.background,c[n][l]=t.rows[n].cells[l].style.color,"rgb(176, 224, 230)"!=t.rows[n].cells[l].style.background?t.rows[n].cells[l].style.background="rgb(176, 224, 230)":t.rows[n].cells[l].style.background=o)}}let f={x:0,y:0};function g(e){n(4,f.x=e.clientX,f),n(4,f.y=e.clientY,f),d(e)}document.addEventListener("click",g);return[o,l,u,s,f,a,function(){const e=document.getElementsByClassName("sapEpmUiControlCrosstabTableInner")[0];for(let t=0;t<e.rows.length;t++)for(let n=0;n<e.rows[t].cells.length;n++)"rgb(176, 224, 230)"==e.rows[t].cells[n].style.background&&(e.rows[t].cells[n].style.background=o)},function(){const e=document.getElementsByClassName("sapEpmUiControlCrosstabTableInner")[0];for(let t=0;t<e.rows.length;t++)for(let n=0;n<e.rows[t].cells.length;n++)"rgb(176, 224, 230)"==e.rows[t].cells[n].style.background&&(e.rows[t].cells[n].style.color=l),e.rows[t].cells[n].style.background=r[t][n]},function(e){return function(){const t=document.getElementsByClassName("sapEpmUiControlCrosstabTableInner")[0];for(let n=0;n<t.rows.length;n++)for(let o=0;o<t.rows[n].cells.length;o++)"rgb(176, 224, 230)"==t.rows[n].cells[o].style.background&&(t.rows[n].cells[o].style.fontStyle=z(t.rows[n].cells[o].style,e)),t.rows[n].cells[o].style.background=r[n][o]}},g,r,c,i,function(e){return function(){let t=0,o=0;n(2,u=parseInt(u));const l=document.getElementsByTagName("tr");u<=4?(t=function(e){let t=0;return e<=2?t=2:3!==e&&4!==e||(t=3),t}(u),o=function(e){let t=0;return 1===e||3===e?t=1:2!==e&&4!==e||(t=2),t}(u),i(l[t].cells[o],e)):5===u?(i(l[2].cells[1],e),i(l[2].cells[2],e)):6===u?(i(l[3].cells[1],e),i(l[3].cells[2],e)):7===u?(i(l[2].cells[1],e),i(l[3].cells[1],e)):8===u?(i(l[2].cells[2],e),i(l[3].cells[2],e)):(i(l[2].cells[1],e),i(l[2].cells[2],e),i(l[3].cells[1],e),i(l[3].cells[2],e))}},d,function(){u=C(this),n(2,u)},function(){o=C(this),n(0,o),n(5,a)},function(){l=C(this),n(1,l),n(5,a)},function(){s=this.__value,n(3,s)},[[]],function(){s=this.__value,n(3,s)}]}t.default=class extends U{constructor(e){super(),H(this,e,F,Y,u,{})}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3dlYmNvbXBvbmVudC9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvc3ZlbHRlL2ludGVybmFsL2luZGV4Lm1qcyIsIndlYnBhY2s6Ly8vLi9zcmMvd2ViY29tcG9uZW50L2NvbXBvbmVudHMvQXBwLnN2ZWx0ZSJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIl9faW1wb3J0RGVmYXVsdCIsInRoaXMiLCJtb2QiLCJBcHBfc3ZlbHRlXzEiLCJ0ZW1wbGF0ZSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsIkNvbXBvbmVudCIsIkhUTUxFbGVtZW50Iiwic3VwZXIiLCJfc2hhZG93Um9vdCIsImF0dGFjaFNoYWRvdyIsImFwcGVuZENoaWxkIiwiY29udGVudCIsImNsb25lTm9kZSIsImluaXRDb21wb25lbnRzIiwiZGVmYXVsdCIsInRhcmdldCIsImdldEVsZW1lbnRCeUlkIiwiY3VzdG9tRWxlbWVudHMiLCJkZWZpbmUiLCJub29wIiwicnVuIiwiZm4iLCJibGFua19vYmplY3QiLCJydW5fYWxsIiwiZm5zIiwiZm9yRWFjaCIsImlzX2Z1bmN0aW9uIiwidGhpbmciLCJzYWZlX25vdF9lcXVhbCIsImEiLCJiIiwiU2V0IiwiYXBwZW5kIiwibm9kZSIsImluc2VydCIsImFuY2hvciIsImluc2VydEJlZm9yZSIsImRldGFjaCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImRlc3Ryb3lfZWFjaCIsIml0ZXJhdGlvbnMiLCJkZXRhY2hpbmciLCJsZW5ndGgiLCJkYXRhIiwiY3JlYXRlVGV4dE5vZGUiLCJzcGFjZSIsImxpc3RlbiIsImV2ZW50IiwiaGFuZGxlciIsIm9wdGlvbnMiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImF0dHIiLCJhdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJnZXRBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJzZXRfZGF0YSIsInRleHQiLCJzZXRfc3R5bGUiLCJpbXBvcnRhbnQiLCJzdHlsZSIsInNldFByb3BlcnR5Iiwic2VsZWN0X29wdGlvbiIsInNlbGVjdCIsIm9wdGlvbiIsIl9fdmFsdWUiLCJzZWxlY3RlZCIsInNlbGVjdF92YWx1ZSIsInNlbGVjdGVkX29wdGlvbiIsInF1ZXJ5U2VsZWN0b3IiLCJjdXJyZW50X2NvbXBvbmVudCIsInNldF9jdXJyZW50X2NvbXBvbmVudCIsImNvbXBvbmVudCIsImRpcnR5X2NvbXBvbmVudHMiLCJiaW5kaW5nX2NhbGxiYWNrcyIsInJlbmRlcl9jYWxsYmFja3MiLCJmbHVzaF9jYWxsYmFja3MiLCJyZXNvbHZlZF9wcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJ1cGRhdGVfc2NoZWR1bGVkIiwic2NoZWR1bGVfdXBkYXRlIiwidGhlbiIsImZsdXNoIiwiYWRkX3JlbmRlcl9jYWxsYmFjayIsInB1c2giLCJzZWVuX2NhbGxiYWNrcyIsInNoaWZ0IiwidXBkYXRlIiwiJCQiLCJwb3AiLCJjYWxsYmFjayIsImhhcyIsImFkZCIsImNsZWFyIiwiZnJhZ21lbnQiLCJiZWZvcmVfdXBkYXRlIiwiZGlydHkiLCJjdHgiLCJhZnRlcl91cGRhdGUiLCJvdXRyb2luZyIsInRyYW5zaXRpb25faW4iLCJibG9jayIsImxvY2FsIiwiZGVsZXRlIiwid2luZG93IiwiZ2xvYmFsIiwiU3ZlbHRlRWxlbWVudCIsImRlc3Ryb3lfY29tcG9uZW50Iiwib25fZGVzdHJveSIsImluaXQiLCJpbnN0YW5jZSIsImNyZWF0ZV9mcmFnbWVudCIsIm5vdF9lcXVhbCIsInByb3BzIiwicGFyZW50X2NvbXBvbmVudCIsInByb3BfdmFsdWVzIiwiYm91bmQiLCJvbl9tb3VudCIsImNvbnRleHQiLCJNYXAiLCJjYWxsYmFja3MiLCJyZWFkeSIsImVsZW1lbnQiLCJyZXQiLCJyZXN0IiwiZmlsbCIsIm1ha2VfZGlydHkiLCJoeWRyYXRlIiwiQXJyYXkiLCJmcm9tIiwiY2hpbGROb2RlcyIsImludHJvIiwibmV3X29uX2Rlc3Ryb3kiLCJtYXAiLCJmaWx0ZXIiLCJtb3VudF9jb21wb25lbnQiLCJzbG90dGVkIiwiX29sZFZhbHVlIiwibmV3VmFsdWUiLCIkZGVzdHJveSIsInR5cGUiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJTdmVsdGVDb21wb25lbnQiLCJkcm9wQ29sb3IiLCJ4IiwieSIsInRleHRXZWlnaHRUcmlnZ2VyIiwiY2VsbEZvbnRTdHlsZSIsInRyaWdnZXIiLCJmb250U3R5bGUiLCJmb250V2VpZ2h0IiwiY29sb3JTZWxlY3RWYWx1ZSIsInR4dENvbG9yU2VsZWN0VmFsdWUiLCJiZ0NvbG9yQXJyYXkiLCJ0eHRDb2xvckFycmF5IiwiY29sb3JzIiwiZGVzdFNlbGVjdFZhbHVlIiwic2VsZWN0U2NvcGUiLCJtYW5pcHVsYXRlQXJlYVNlbGVjdGVkIiwidGFibGVDZWxsIiwicmVjQnV0dG9uIiwiYmFja2dyb3VuZCIsImNvbG9yIiwic3BlY2lmeVRhYmxlUm93IiwidGFibGVDb250IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsInJvd3MiLCJqIiwiY2VsbHMiLCJjbG9zZXN0IiwiZGF0YXNldCIsInJvdyIsImNvbCIsIm1Qb3MiLCJoYW5kbGVNb3VzZUNsaWNrIiwiY2xpZW50WCIsImNsaWVudFkiLCJzZWxlY3RlZERhdGFSb3ciLCJzZWxlY3RlZERhdGFDb2wiLCJwYXJzZUludCIsInRhYmxlU2VsZWN0aW9uIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJzZWxlY3RlZFJvdyIsInNlbGVjdGVkQ29sIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9ILEVBQ2hGLElBQUlJLEVBQUtYLE9BQU9ZLE9BQU8sTUFHdkIsR0FGQTFCLEVBQW9Ca0IsRUFBRU8sR0FDdEJYLE9BQU9DLGVBQWVVLEVBQUksVUFBVyxDQUFFVCxZQUFZLEVBQU1LLE1BQU9BLElBQ3RELEVBQVBFLEdBQTRCLGlCQUFURixFQUFtQixJQUFJLElBQUlNLEtBQU9OLEVBQU9yQixFQUFvQlUsRUFBRWUsRUFBSUUsRUFBSyxTQUFTQSxHQUFPLE9BQU9OLEVBQU1NLElBQVFDLEtBQUssS0FBTUQsSUFDOUksT0FBT0YsR0FJUnpCLEVBQW9CNkIsRUFBSSxTQUFTMUIsR0FDaEMsSUFBSVMsRUFBU1QsR0FBVUEsRUFBT3FCLFdBQzdCLFdBQXdCLE9BQU9yQixFQUFnQixTQUMvQyxXQUE4QixPQUFPQSxHQUV0QyxPQURBSCxFQUFvQlUsRUFBRUUsRUFBUSxJQUFLQSxHQUM1QkEsR0FJUlosRUFBb0JhLEVBQUksU0FBU2lCLEVBQVFDLEdBQVksT0FBT2pCLE9BQU9rQixVQUFVQyxlQUFlMUIsS0FBS3VCLEVBQVFDLElBR3pHL0IsRUFBb0JrQyxFQUFJLEdBSWpCbEMsRUFBb0JBLEVBQW9CbUMsRUFBSSxHLCtCQ2pGckQsSUFBSUMsRUFBbUJDLE1BQVFBLEtBQUtELGlCQUFvQixTQUFVRSxHQUM5RCxPQUFRQSxHQUFPQSxFQUFJZCxXQUFjYyxFQUFNLENBQUUsUUFBV0EsSUFFeER4QixPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sSUFDdEQsTUFBTWtCLEVBQWVILEVBQWdCLEVBQVEsSUFDN0MsTUFDSSxNQUFNSSxFQUFXQyxTQUFTQyxjQUFjLFlBQ3hDRixFQUFTRyxVQUFZLDBEQUdyQixNQUFNQyxVQUFrQkMsWUFDcEIsY0FDSUMsUUFDQVQsS0FBS1UsWUFBY1YsS0FBS1csYUFBYSxDQUNqQ3pCLEtBQU0sU0FFVmMsS0FBS1UsWUFBWUUsWUFBWVQsRUFBU1UsUUFBUUMsV0FBVSxJQUN4RGQsS0FBS2UsaUJBRVQsaUJBQ0ksSUFBSWIsRUFBYWMsUUFBUSxDQUNyQkMsT0FBUWpCLEtBQUtVLFlBQVlRLGVBQWUsaUNBSXBEQyxlQUFlQyxPQUFPLG1CQUFvQmIsSUFwQjlDLEksOEJDTkEsU0FBU2MsSyxPQWdCVCxTQUFTQyxFQUFJQyxHQUNULE9BQU9BLElBRVgsU0FBU0MsSUFDTCxPQUFPL0MsT0FBT1ksT0FBTyxNQUV6QixTQUFTb0MsRUFBUUMsR0FDYkEsRUFBSUMsUUFBUUwsR0FFaEIsU0FBU00sRUFBWUMsR0FDakIsTUFBd0IsbUJBQVZBLEVBRWxCLFNBQVNDLEVBQWVDLEVBQUdDLEdBQ3ZCLE9BQU9ELEdBQUtBLEVBQUlDLEdBQUtBLEVBQUlELElBQU1DLEdBQU9ELEdBQWtCLGlCQUFOQSxHQUFnQyxtQkFBTkEsRUE0RmxFLElBQUlFLElBbUNsQixTQUFTQyxFQUFPakIsRUFBUWtCLEdBQ3BCbEIsRUFBT0wsWUFBWXVCLEdBRXZCLFNBQVNDLEVBQU9uQixFQUFRa0IsRUFBTUUsR0FDMUJwQixFQUFPcUIsYUFBYUgsRUFBTUUsR0FBVSxNQUV4QyxTQUFTRSxFQUFPSixHQUNaQSxFQUFLSyxXQUFXQyxZQUFZTixHQUVoQyxTQUFTTyxFQUFhQyxFQUFZQyxHQUM5QixJQUFLLElBQUk3RSxFQUFJLEVBQUdBLEVBQUk0RSxFQUFXRSxPQUFROUUsR0FBSyxFQUNwQzRFLEVBQVc1RSxJQUNYNEUsRUFBVzVFLEdBQUdNLEVBQUV1RSxHQUc1QixTQUFTLEVBQVF0RSxHQUNiLE9BQU84QixTQUFTQyxjQUFjL0IsR0FvQmxDLFNBQVMsRUFBS3dFLEdBQ1YsT0FBTzFDLFNBQVMyQyxlQUFlRCxHQUVuQyxTQUFTRSxJQUNMLE9BQU8sRUFBSyxLQUtoQixTQUFTQyxFQUFPZCxFQUFNZSxFQUFPQyxFQUFTQyxHQUVsQyxPQURBakIsRUFBS2tCLGlCQUFpQkgsRUFBT0MsRUFBU0MsR0FDL0IsSUFBTWpCLEVBQUttQixvQkFBb0JKLEVBQU9DLEVBQVNDLEdBdUIxRCxTQUFTRyxFQUFLcEIsRUFBTXFCLEVBQVd4RSxHQUNkLE1BQVRBLEVBQ0FtRCxFQUFLc0IsZ0JBQWdCRCxHQUNoQnJCLEVBQUt1QixhQUFhRixLQUFleEUsR0FDdENtRCxFQUFLd0IsYUFBYUgsRUFBV3hFLEdBeUZyQyxTQUFTNEUsRUFBU0MsRUFBTWYsR0FDcEJBLEVBQU8sR0FBS0EsRUFDUmUsRUFBS2YsT0FBU0EsSUFDZGUsRUFBS2YsS0FBT0EsR0FlcEIsU0FBU2dCLEVBQVUzQixFQUFNN0MsRUFBS04sRUFBTytFLEdBQ2pDNUIsRUFBSzZCLE1BQU1DLFlBQVkzRSxFQUFLTixFQUFPK0UsRUFBWSxZQUFjLElBRWpFLFNBQVNHLEVBQWNDLEVBQVFuRixHQUMzQixJQUFLLElBQUlqQixFQUFJLEVBQUdBLEVBQUlvRyxFQUFPZixRQUFRUCxPQUFROUUsR0FBSyxFQUFHLENBQy9DLE1BQU1xRyxFQUFTRCxFQUFPZixRQUFRckYsR0FDOUIsR0FBSXFHLEVBQU9DLFVBQVlyRixFQUVuQixZQURBb0YsRUFBT0UsVUFBVyxJQVc5QixTQUFTQyxFQUFhSixHQUNsQixNQUFNSyxFQUFrQkwsRUFBT00sY0FBYyxhQUFlTixFQUFPZixRQUFRLEdBQzNFLE9BQU9vQixHQUFtQkEsRUFBZ0JILFFBdUU5QyxJQTZISUssRUFDSixTQUFTQyxFQUFzQkMsR0FDM0JGLEVBQW9CRSxFQWlEeEIsTUFBTUMsRUFBbUIsR0FFbkJDLEVBQW9CLEdBQ3BCQyxFQUFtQixHQUNuQkMsRUFBa0IsR0FDbEJDLEVBQW1CQyxRQUFRQyxVQUNqQyxJQUFJQyxHQUFtQixFQUN2QixTQUFTQyxJQUNBRCxJQUNEQSxHQUFtQixFQUNuQkgsRUFBaUJLLEtBQUtDLElBTzlCLFNBQVNDLEVBQW9CakUsR0FDekJ3RCxFQUFpQlUsS0FBS2xFLEdBSzFCLE1BQU1tRSxFQUFpQixJQUFJekQsSUFDM0IsU0FBU3NELElBQ0wsRUFBRyxDQUdDLEtBQU9WLEVBQWlCaEMsUUFBUSxDQUM1QixNQUFNK0IsRUFBWUMsRUFBaUJjLFFBQ25DaEIsRUFBc0JDLEdBQ3RCZ0IsRUFBT2hCLEVBQVVpQixJQUVyQixLQUFPZixFQUFrQmpDLFFBQ3JCaUMsRUFBa0JnQixLQUFsQmhCLEdBSUosSUFBSyxJQUFJL0csRUFBSSxFQUFHQSxFQUFJZ0gsRUFBaUJsQyxPQUFROUUsR0FBSyxFQUFHLENBQ2pELE1BQU1nSSxFQUFXaEIsRUFBaUJoSCxHQUM3QjJILEVBQWVNLElBQUlELEtBRXBCTCxFQUFlTyxJQUFJRixHQUNuQkEsS0FHUmhCLEVBQWlCbEMsT0FBUyxRQUNyQmdDLEVBQWlCaEMsUUFDMUIsS0FBT21DLEVBQWdCbkMsUUFDbkJtQyxFQUFnQmMsS0FBaEJkLEdBRUpJLEdBQW1CLEVBQ25CTSxFQUFlUSxRQUVuQixTQUFTTixFQUFPQyxHQUNaLEdBQW9CLE9BQWhCQSxFQUFHTSxTQUFtQixDQUN0Qk4sRUFBR0QsU0FDSG5FLEVBQVFvRSxFQUFHTyxlQUNYLE1BQU1DLEVBQVFSLEVBQUdRLE1BQ2pCUixFQUFHUSxNQUFRLEVBQUUsR0FDYlIsRUFBR00sVUFBWU4sRUFBR00sU0FBU3RHLEVBQUVnRyxFQUFHUyxJQUFLRCxHQUNyQ1IsRUFBR1UsYUFBYTVFLFFBQVE2RCxJQWlCaEMsTUFBTWdCLEVBQVcsSUFBSXZFLElBZXJCLFNBQVN3RSxFQUFjQyxFQUFPQyxHQUN0QkQsR0FBU0EsRUFBTTNJLElBQ2Z5SSxFQUFTSSxPQUFPRixHQUNoQkEsRUFBTTNJLEVBQUU0SSxJQXNUbUIsb0JBQVhFLE9BQXlCQSxPQUFTQyxPQStJL0IsSUFBSTdFLElBQUksQ0FDL0Isa0JBQ0Esc0JBQ0EsUUFDQSxZQUNBLFdBQ0EsVUFDQSxXQUNBLFVBQ0EsUUFDQSxXQUNBLGlCQUNBLFNBQ0EsUUFDQSxPQUNBLFdBQ0EsUUFDQSxXQUNBLGFBQ0EsT0FDQSxjQUNBLFdBQ0EsV0FDQSxXQUNBLGFBa0VKLElBdUpJOEUsRUEzRUosU0FBU0MsRUFBa0JwQyxFQUFXaEMsR0FDbEMsTUFBTWlELEVBQUtqQixFQUFVaUIsR0FDRCxPQUFoQkEsRUFBR00sV0FDSDFFLEVBQVFvRSxFQUFHb0IsWUFDWHBCLEVBQUdNLFVBQVlOLEVBQUdNLFNBQVM5SCxFQUFFdUUsR0FHN0JpRCxFQUFHb0IsV0FBYXBCLEVBQUdNLFNBQVcsS0FDOUJOLEVBQUdTLElBQU0sSUFXakIsU0FBU1ksRUFBS3RDLEVBQVd4QixFQUFTK0QsRUFBVUMsRUFBaUJDLEVBQVdDLEVBQU9qQixFQUFRLEVBQUUsSUFDckYsTUFBTWtCLEVBQW1CN0MsRUFDekJDLEVBQXNCQyxHQUN0QixNQUFNNEMsRUFBY3BFLEVBQVFrRSxPQUFTLEdBQy9CekIsRUFBS2pCLEVBQVVpQixHQUFLLENBQ3RCTSxTQUFVLEtBQ1ZHLElBQUssS0FFTGdCLFFBQ0ExQixPQUFRdkUsRUFDUmdHLFlBQ0FJLE1BQU9qRyxJQUVQa0csU0FBVSxHQUNWVCxXQUFZLEdBQ1piLGNBQWUsR0FDZkcsYUFBYyxHQUNkb0IsUUFBUyxJQUFJQyxJQUFJTCxFQUFtQkEsRUFBaUIxQixHQUFHOEIsUUFBVSxJQUVsRUUsVUFBV3JHLElBQ1g2RSxTQUVKLElBQUl5QixHQUFRLEVBcGpDaEIsSUFBa0JDLEVBcWpDZGxDLEVBQUdTLElBQU1hLEVBQ0hBLEVBQVN2QyxFQUFXNEMsRUFBYSxDQUFDekosRUFBR2lLLEtBQVFDLEtBQzNDLE1BQU1qSixFQUFRaUosRUFBS3BGLE9BQVNvRixFQUFLLEdBQUtELEVBT3RDLE9BTkluQyxFQUFHUyxLQUFPZSxFQUFVeEIsRUFBR1MsSUFBSXZJLEdBQUk4SCxFQUFHUyxJQUFJdkksR0FBS2lCLEtBQ3ZDNkcsRUFBRzRCLE1BQU0xSixJQUNUOEgsRUFBRzRCLE1BQU0xSixHQUFHaUIsR0FDWjhJLEdBckNwQixTQUFvQmxELEVBQVc3RyxJQUNJLElBQTNCNkcsRUFBVWlCLEdBQUdRLE1BQU0sS0FDbkJ4QixFQUFpQlksS0FBS2IsR0FDdEJTLElBQ0FULEVBQVVpQixHQUFHUSxNQUFNNkIsS0FBSyxJQUU1QnRELEVBQVVpQixHQUFHUSxNQUFPdEksRUFBSSxHQUFNLElBQU8sR0FBTUEsRUFBSSxHQWdDL0JvSyxDQUFXdkQsRUFBVzdHLElBRXZCaUssSUFFVCxHQUNObkMsRUFBR0QsU0FDSGtDLEdBQVEsRUFDUnJHLEVBQVFvRSxFQUFHTyxlQUVYUCxFQUFHTSxXQUFXaUIsR0FBa0JBLEVBQWdCdkIsRUFBR1MsS0FDL0NsRCxFQUFRbkMsU0FDSm1DLEVBQVFnRixRQUVSdkMsRUFBR00sVUFBWU4sRUFBR00sU0FBU25JLEdBemtDckIrSixFQXlrQ2dDM0UsRUFBUW5DLE9BeGtDL0NvSCxNQUFNQyxLQUFLUCxFQUFRUSxjQTRrQ2xCMUMsRUFBR00sVUFBWU4sRUFBR00sU0FBUy9ILElBRTNCZ0YsRUFBUW9GLE9BQ1IvQixFQUFjN0IsRUFBVWlCLEdBQUdNLFVBdkZ2QyxTQUF5QnZCLEVBQVczRCxFQUFRb0IsR0FDeEMsTUFBTSxTQUFFOEQsRUFBUSxTQUFFdUIsRUFBUSxXQUFFVCxFQUFVLGFBQUVWLEdBQWlCM0IsRUFBVWlCLEdBQ25FTSxHQUFZQSxFQUFTaEksRUFBRThDLEVBQVFvQixHQUUvQm1ELEVBQW9CLEtBQ2hCLE1BQU1pRCxFQUFpQmYsRUFBU2dCLElBQUlwSCxHQUFLcUgsT0FBTy9HLEdBQzVDcUYsRUFDQUEsRUFBV3hCLFFBQVFnRCxHQUtuQmhILEVBQVFnSCxHQUVaN0QsRUFBVWlCLEdBQUc2QixTQUFXLEtBRTVCbkIsRUFBYTVFLFFBQVE2RCxHQXdFakJvRCxDQUFnQmhFLEVBQVd4QixFQUFRbkMsT0FBUW1DLEVBQVFmLFFBQ25Ea0QsS0FFSlosRUFBc0I0QyxHQUdDLG1CQUFoQi9HLGNBQ1B1RyxFQUFnQixjQUFjdkcsWUFDMUIsY0FDSUMsUUFDQVQsS0FBS1csYUFBYSxDQUFFekIsS0FBTSxTQUU5QixvQkFFSSxJQUFLLE1BQU1JLEtBQU9VLEtBQUs2RixHQUFHZ0QsUUFFdEI3SSxLQUFLWSxZQUFZWixLQUFLNkYsR0FBR2dELFFBQVF2SixJQUd6Qyx5QkFBeUJpRSxFQUFNdUYsRUFBV0MsR0FDdEMvSSxLQUFLdUQsR0FBUXdGLEVBRWpCLFdBQ0kvQixFQUFrQmhILEtBQU0sR0FDeEJBLEtBQUtnSixTQUFXM0gsRUFFcEIsSUFBSTRILEVBQU1sRCxHQUVOLE1BQU04QixFQUFhN0gsS0FBSzZGLEdBQUdnQyxVQUFVb0IsS0FBVWpKLEtBQUs2RixHQUFHZ0MsVUFBVW9CLEdBQVEsSUFFekUsT0FEQXBCLEVBQVVwQyxLQUFLTSxHQUNSLEtBQ0gsTUFBTW1ELEVBQVFyQixFQUFVc0IsUUFBUXBELElBQ2pCLElBQVhtRCxHQUNBckIsRUFBVXVCLE9BQU9GLEVBQU8sSUFHcEMsV0FLUixNQUFNRyxFQUNGLFdBQ0lyQyxFQUFrQmhILEtBQU0sR0FDeEJBLEtBQUtnSixTQUFXM0gsRUFFcEIsSUFBSTRILEVBQU1sRCxHQUNOLE1BQU04QixFQUFhN0gsS0FBSzZGLEdBQUdnQyxVQUFVb0IsS0FBVWpKLEtBQUs2RixHQUFHZ0MsVUFBVW9CLEdBQVEsSUFFekUsT0FEQXBCLEVBQVVwQyxLQUFLTSxHQUNSLEtBQ0gsTUFBTW1ELEVBQVFyQixFQUFVc0IsUUFBUXBELElBQ2pCLElBQVhtRCxHQUNBckIsRUFBVXVCLE9BQU9GLEVBQU8sSUFHcEMsUywwSUN2cUNpRyxFQUFLLElBQUM1SyxLQUFJLEcsNENBQW5GLEVBQUssSUFBQ1UsTSxtQ0FBMkIsRUFBSyxJQUFDQSxPLFlBQWMsRUFBSyxJQUFDc0ssWSxxRUFNYyxFQUFLLElBQUNoTCxLQUFJLEcsNENBQW5GLEVBQUssSUFBQ1UsTSxtQ0FBMkIsRUFBSyxJQUFDQSxPLFlBQWMsRUFBSyxJQUFDc0ssWSwySkF0QjNFLEVBQUksR0FBQ0MsRUFBQyxHLEdBQUssRUFBSSxHQUFDQyxFQUFDLEcsR0FlZCxFQUFNLEcsdUJBQVgsT0FBSSxLLDBCQU1DLEVBQU0sRyx1QkFBWCxPQUFJLEssb3ZDQW5Cc0IsSUFBZixFQUFlLDhCQVlDLElBQWhCLEVBQWdCLDhCQU1HLElBQW5CLEVBQW1CLHlCLDBEQVM2QixFLGlIQUtBLEUsaUtBaENoRCxFQUFlLEksK0RBWWYsRUFBZ0IsSSwrREFNaEIsRUFBbUIsSSxnRUFTUyxFQUFXLEcsa0RBS1gsRUFBVyxHLHlMQU0xQyxFQUFvQixJLGFBQ3BCLEVBQXVCLEksYUFDdkIsRUFBd0IsR0FBQyxJLGFBQ3pCLEVBQXdCLEdBQUMsSSxZQTVDNUIsRUFBZ0IsTSwyQkFDbkIsRUFBSSxHQUFDRCxFQUFDLGEsZUFBSyxFQUFJLEdBQUNDLEVBQUMsYSxTQUVSLEVBQWUsSSxtQkFhckIsRUFBTSxHLFNBQVgsT0FBSSxNLDBIQUFKLE8sWUFEVyxFQUFnQixJLG1CQU90QixFQUFNLEcsU0FBWCxPQUFJLE0sMEhBQUosTyxTQURXLEVBQW1CLEksNEJBU1MsRUFBVyxJLDRCQUtYLEVBQVcsSyxvSUFyRi9DQyxFQUFrQkMsRUFBY0MsRyxNQUVOLFVBQTNCRCxFQUFjRSxXQUFvQyxHQUFYRCxFQUNoQyxTQUV5QixVQUEzQkQsRUFBY0UsV0FBb0MsR0FBWEQsRUFDckMsR0FFMEIsUUFBNUJELEVBQWNHLFlBQW1DLEdBQVhGLEVBQ3BDLE9BR0EsUyxzQkFyTVhHLEVBQW1CLHFCQUNuQkMsRUFBc0IsZSxNQUVwQkMsRUFBZSxHQUNmQyxFQUFnQixHLElBSWxCQyxFQUFTLEMsQ0FDUmxMLE1BQU8scUJBQXNCVixLQUFNLFFBQVNnTCxVQUFXLGdCLENBQ3ZEdEssTUFBTyxxQkFBc0JWLEtBQU0sYUFBY2dMLFVBQVcsZ0IsQ0FDNUR0SyxNQUFPLHFCQUFzQlYsS0FBTSxPQUFRZ0wsVUFBVyxnQixDQUN0RHRLLE1BQU8sa0JBQW1CVixLQUFNLFlBQWFnTCxVQUFXLHNCLENBQ3hEdEssTUFBTyxlQUFnQlYsS0FBTSxRQUFTZ0wsVUFBVyxzQixDQUNqRHRLLE1BQU8sbUJBQW9CVixLQUFNLFNBQVVnTCxVQUFXLGdCLENBQ3REdEssTUFBTyxxQkFBc0JWLEtBQU0sUUFBU2dMLFVBQVcsZ0IsQ0FDdkR0SyxNQUFPLHFCQUFzQlYsS0FBTSxhQUFjZ0wsVUFBVyxnQixDQUM1RHRLLE1BQU8sbUJBQW9CVixLQUFNLFNBQVVnTCxVQUFXLGdCLENBQ3REdEssTUFBTyxrQkFBbUJWLEtBQU0sYUFBY2dMLFVBQVcsZ0IsQ0FDekR0SyxNQUFPLGlCQUFrQlYsS0FBTSxNQUFPZ0wsVUFBVyxnQixDQUNqRHRLLE1BQU8sbUJBQW9CVixLQUFNLGFBQWNnTCxVQUFXLHNCLENBQzFEdEssTUFBTyxxQkFBc0JWLEtBQU0sY0FBZWdMLFVBQVcsZ0IsQ0FDN0R0SyxNQUFPLG1CQUFvQlYsS0FBTSxjQUFlZ0wsVUFBVyxnQixDQUMzRHRLLE1BQU8saUJBQWtCVixLQUFNLE9BQVFnTCxVQUFXLHNCLENBQ2xEdEssTUFBTyxvQkFBcUJWLEtBQU0sY0FBZWdMLFVBQVcsZ0IsQ0FDNUR0SyxNQUFPLG1CQUFvQlYsS0FBTSxlQUFnQmdMLFVBQVcsZ0IsQ0FDNUR0SyxNQUFPLG1CQUFvQlYsS0FBTSxhQUFjZ0wsVUFBVyxnQixDQUMxRHRLLE1BQU8saUJBQWtCVixLQUFNLFFBQVNnTCxVQUFXLGlCQUdwRGEsRUFBa0IsSUE0QmxCQyxFQUFjLEUsU0FFVEMsRUFBdUJDLEVBQVdDLEdBQ3JCLElBQWRBLEVBQ21CLEdBQWZILEVBQ0FFLEVBQVV0RyxNQUFNd0csV0FBYVYsRUFLN0JRLEVBQVV0RyxNQUFNeUcsTUFBUVgsRUFHVCxJQUFkUyxFQUNMRCxFQUFVdEcsTUFBTTRGLFVBQVksU0FFVCxJQUFkVyxJQUNMRCxFQUFVdEcsTUFBTTRGLFVBQVksUSxTQXVEM0JjLEVBQWdCeEgsRyxNQUVmeUgsRUFBWXZLLFNBQVN3Syx1QkFBdUIscUNBQXFDLEcsUUFHOUU3TSxFQUFJLEVBQUdBLEVBQUk0TSxFQUFVRSxLQUFLaEksT0FBUTlFLElBQUMsQ0FFeENpTSxFQUFhdkUsS0FBSyxJQUNsQndFLEVBQWN4RSxLQUFLLEksUUFFVnFGLEVBQUksRUFBR0EsRUFBSUgsRUFBVUUsS0FBSzlNLEdBQUdnTixNQUFNbEksT0FBUWlJLElBRWQsTUFBOUI1SCxFQUFNakMsT0FBTytKLFFBQVEsT0FBaUI5SCxFQUFNakMsT0FBTytKLFFBQVEsTUFBTUMsUUFBUUMsS0FBT25OLEdBQW1DLE1BQTlCbUYsRUFBTWpDLE9BQU8rSixRQUFRLE9BQWlCOUgsRUFBTWpDLE9BQU8rSixRQUFRLE1BQU1DLFFBQVFFLEtBQU9MLElBRXJLZCxFQUFhak0sR0FBRytNLEdBQUtILEVBQVVFLEtBQUs5TSxHQUFHZ04sTUFBTUQsR0FBRzlHLE1BQU13RyxXQUN0RFAsRUFBY2xNLEdBQUcrTSxHQUFLSCxFQUFVRSxLQUFLOU0sR0FBR2dOLE1BQU1ELEdBQUc5RyxNQUFNeUcsTUFHSixzQkFBL0NFLEVBQVVFLEtBQUs5TSxHQUFHZ04sTUFBTUQsR0FBRzlHLE1BQU13RyxXQUNqQ0csRUFBVUUsS0FBSzlNLEdBQUdnTixNQUFNRCxHQUFHOUcsTUFBTXdHLFdBQWEscUJBRzlDRyxFQUFVRSxLQUFLOU0sR0FBR2dOLE1BQU1ELEdBQUc5RyxNQUFNd0csV0FBYVYsSSxJQW1FOURzQixFQUFPLENBQUU3QixFQUFFLEVBQUdDLEVBQUUsRyxTQUNYNkIsRUFBaUJuSSxHLElBQ3RCa0ksRUFBSzdCLEVBQUlyRyxFQUFNb0ksUUFBTyxHLElBQ3RCRixFQUFLNUIsRUFBSXRHLEVBQU1xSSxRQUFPLEdBRXRCYixFQUFnQnhILEdBT3BCOUMsU0FBU2lELGlCQUFpQixRQUFTZ0ksRyxvQ0F2RXpCVixFQUFZdkssU0FBU3dLLHVCQUF1QixxQ0FBcUMsRyxRQUU5RTdNLEVBQUksRUFBR0EsRUFBSTRNLEVBQVVFLEtBQUtoSSxPQUFROUUsSSxRQUM5QitNLEVBQUksRUFBR0EsRUFBSUgsRUFBVUUsS0FBSzlNLEdBQUdnTixNQUFNbEksT0FBUWlJLElBRUcsc0JBQS9DSCxFQUFVRSxLQUFLOU0sR0FBR2dOLE1BQU1ELEdBQUc5RyxNQUFNd0csYUFDakNHLEVBQVVFLEtBQUs5TSxHQUFHZ04sTUFBTUQsR0FBRzlHLE1BQU13RyxXQUFhVixJLGlCQU9wRGEsRUFBWXZLLFNBQVN3Syx1QkFBdUIscUNBQXFDLEcsUUFDOUU3TSxFQUFJLEVBQUdBLEVBQUk0TSxFQUFVRSxLQUFLaEksT0FBUTlFLEksUUFDOUIrTSxFQUFJLEVBQUdBLEVBQUlILEVBQVVFLEtBQUs5TSxHQUFHZ04sTUFBTWxJLE9BQVFpSSxJQUVHLHNCQUEvQ0gsRUFBVUUsS0FBSzlNLEdBQUdnTixNQUFNRCxHQUFHOUcsTUFBTXdHLGFBQ2pDRyxFQUFVRSxLQUFLOU0sR0FBR2dOLE1BQU1ELEdBQUc5RyxNQUFNeUcsTUFBUVYsR0FFN0NZLEVBQVVFLEtBQUs5TSxHQUFHZ04sTUFBTUQsR0FBRzlHLE1BQU13RyxXQUFhUixFQUFhak0sR0FBRytNLEksU0FxQnhDbkIsRyx3QkFFcEJnQixFQUFZdkssU0FBU3dLLHVCQUF1QixxQ0FBcUMsRyxRQUM5RTdNLEVBQUksRUFBR0EsRUFBSTRNLEVBQVVFLEtBQUtoSSxPQUFROUUsSSxRQUM5QitNLEVBQUksRUFBR0EsRUFBSUgsRUFBVUUsS0FBSzlNLEdBQUdnTixNQUFNbEksT0FBUWlJLElBRUcsc0JBQS9DSCxFQUFVRSxLQUFLOU0sR0FBR2dOLE1BQU1ELEdBQUc5RyxNQUFNd0csYUFDakNHLEVBQVVFLEtBQUs5TSxHQUFHZ04sTUFBTUQsR0FBRzlHLE1BQU00RixVQUFZSCxFQUFrQmtCLEVBQVVFLEtBQUs5TSxHQUFHZ04sTUFBTUQsR0FBRzlHLE1BQU8yRixJQUVyR2dCLEVBQVVFLEtBQUs5TSxHQUFHZ04sTUFBTUQsR0FBRzlHLE1BQU13RyxXQUFhUixFQUFhak0sR0FBRytNLEssaUJBaElqRFAsRyxzQkFHakJpQixFQUFrQixFQUNsQkMsRUFBa0IsRSxJQUV0QnRCLEVBQWtCdUIsU0FBU3ZCLEksTUFFckJ3QixFQUFpQnZMLFNBQVN3TCxxQkFBcUIsTUFFakR6QixHQUFtQixHQUVuQnFCLEUsU0E5RFNyQixHLElBRWJxQixFQUFrQixFLE9BRWxCckIsR0FBbUIsRUFDbkJxQixFQUFrQixFQUVPLElBQXBCckIsR0FBNkMsSUFBcEJBLElBQzlCcUIsRUFBa0IsR0FFZkEsRUFvRG1CSyxDQUFZMUIsR0FDOUJzQixFLFNBbERTdEIsRyxJQUVic0IsRUFBa0IsRSxPQUVFLElBQXBCdEIsR0FBNkMsSUFBcEJBLEVBQ3pCc0IsRUFBa0IsRUFFTyxJQUFwQnRCLEdBQTZDLElBQXBCQSxJQUM5QnNCLEVBQWtCLEdBRWZBLEVBd0NtQkssQ0FBWTNCLEdBRTlCRSxFQUF1QnNCLEVBQWVILEdBQWlCVCxNQUFNVSxHQUFrQmxCLElBRXRELElBQXBCSixHQUdMRSxFQUF1QnNCLEVBQWUsR0FBR1osTUFBTSxHQUFJUixHQUNuREYsRUFBdUJzQixFQUFlLEdBQUdaLE1BQU0sR0FBSVIsSUFFMUIsSUFBcEJKLEdBQ0xFLEVBQXVCc0IsRUFBZSxHQUFHWixNQUFNLEdBQUlSLEdBQ25ERixFQUF1QnNCLEVBQWUsR0FBR1osTUFBTSxHQUFJUixJQUUxQixJQUFwQkosR0FDTEUsRUFBdUJzQixFQUFlLEdBQUdaLE1BQU0sR0FBSVIsR0FDbkRGLEVBQXVCc0IsRUFBZSxHQUFHWixNQUFNLEdBQUlSLElBRTFCLElBQXBCSixHQUNMRSxFQUF1QnNCLEVBQWUsR0FBR1osTUFBTSxHQUFJUixHQUNuREYsRUFBdUJzQixFQUFlLEdBQUdaLE1BQU0sR0FBSVIsS0FHbkRGLEVBQXVCc0IsRUFBZSxHQUFHWixNQUFNLEdBQUlSLEdBQ25ERixFQUF1QnNCLEVBQWUsR0FBR1osTUFBTSxHQUFJUixHQUNuREYsRUFBdUJzQixFQUFlLEdBQUdaLE1BQU0sR0FBSVIsR0FDbkRGLEVBQXVCc0IsRUFBZSxHQUFHWixNQUFNLEdBQUlSLE0sYUFxSDlDSixFQUFlLFEsbUJBWWZMLEVBQWdCLFEsMEJBTWhCQyxFQUFtQixRLDBCQVNTSyxFQUFXLGEsd0JBS1hBLEVBQVcsYSIsImZpbGUiOiJ3ZWJjb21wb25lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJcInVzZSBzdHJpY3RcIjtcclxudmFyIF9faW1wb3J0RGVmYXVsdCA9ICh0aGlzICYmIHRoaXMuX19pbXBvcnREZWZhdWx0KSB8fCBmdW5jdGlvbiAobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5jb25zdCBBcHBfc3ZlbHRlXzEgPSBfX2ltcG9ydERlZmF1bHQocmVxdWlyZShcIi4vY29tcG9uZW50cy9BcHAuc3ZlbHRlXCIpKTtcclxuKCgpID0+IHtcclxuICAgIGNvbnN0IHRlbXBsYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGVtcGxhdGUnKTtcclxuICAgIHRlbXBsYXRlLmlubmVySFRNTCA9IGBcbiAgICA8ZGl2IGlkPSdzYWMtYXBwLXJlZGVzaWduX2NvbnRhaW5lcic+PC9kaXY+XG4gICAgYDtcclxuICAgIGNsYXNzIENvbXBvbmVudCBleHRlbmRzIEhUTUxFbGVtZW50IHtcclxuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICAgICAgdGhpcy5fc2hhZG93Um9vdCA9IHRoaXMuYXR0YWNoU2hhZG93KHtcclxuICAgICAgICAgICAgICAgIG1vZGU6ICdvcGVuJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5fc2hhZG93Um9vdC5hcHBlbmRDaGlsZCh0ZW1wbGF0ZS5jb250ZW50LmNsb25lTm9kZSh0cnVlKSk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdENvbXBvbmVudHMoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaW5pdENvbXBvbmVudHMoKSB7XHJcbiAgICAgICAgICAgIG5ldyBBcHBfc3ZlbHRlXzEuZGVmYXVsdCh7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHRoaXMuX3NoYWRvd1Jvb3QuZ2V0RWxlbWVudEJ5SWQoXCJzYWMtYXBwLXJlZGVzaWduX2NvbnRhaW5lclwiKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUoJ3NhYy1hcHAtcmVkZXNpZ24nLCBDb21wb25lbnQpO1xyXG59KSgpO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lhVzVrWlhndWFuTWlMQ0p6YjNWeVkyVlNiMjkwSWpvaUlpd2ljMjkxY21ObGN5STZXeUpwYm1SbGVDNTBjeUpkTENKdVlXMWxjeUk2VzEwc0ltMWhjSEJwYm1keklqb2lPenM3T3p0QlFVTkJMSGxGUVVFd1F6dEJRVVV4UXl4RFFVRkRMRWRCUVVjc1JVRkJSVHRKUVVOR0xFMUJRVTBzVVVGQlVTeEhRVUZITEZGQlFWRXNRMEZCUXl4aFFVRmhMRU5CUVVNc1ZVRkJWU3hEUVVGRExFTkJRVU03U1VGRGNFUXNVVUZCVVN4RFFVRkRMRk5CUVZNc1IwRkJSenM3UzBGRmNFSXNRMEZCUXp0SlFVVkdMRTFCUVUwc1UwRkJWU3hUUVVGUkxGZEJRVmM3VVVGSEwwSTdXVUZEU1N4TFFVRkxMRVZCUVVVc1EwRkJRenRaUVVWU0xFbEJRVWtzUTBGQlF5eFhRVUZYTEVkQlFVY3NTVUZCU1N4RFFVRkRMRmxCUVZrc1EwRkJRenRuUWtGRGFrTXNTVUZCU1N4RlFVRkZMRTFCUVUwN1lVRkRaaXhEUVVGRExFTkJRVU03V1VGRFNDeEpRVUZKTEVOQlFVTXNWMEZCVnl4RFFVRkRMRmRCUVZjc1EwRkJReXhSUVVGUkxFTkJRVU1zVDBGQlR5eERRVUZETEZOQlFWTXNRMEZCUXl4SlFVRkpMRU5CUVVNc1EwRkJReXhEUVVGRE8xbEJSUzlFTEVsQlFVa3NRMEZCUXl4alFVRmpMRVZCUVVVc1EwRkJRenRSUVVNeFFpeERRVUZETzFGQlJVOHNZMEZCWXp0WlFVVnNRaXhKUVVGSkxHOUNRVUZITEVOQlFVTTdaMEpCUTBvc1RVRkJUU3hGUVVGRkxFbEJRVWtzUTBGQlF5eFhRVUZYTEVOQlFVTXNZMEZCWXl4RFFVRkRMRFJDUVVFMFFpeERRVUZETzJGQlEzaEZMRU5CUVVNc1EwRkJRenRSUVVOUUxFTkJRVU03UzBGRFNqdEpRVVZFTEdOQlFXTXNRMEZCUXl4TlFVRk5MRU5CUVVNc2EwSkJRV3RDTEVWQlFVVXNVMEZCVXl4RFFVRkRMRU5CUVVNN1FVRkRla1FzUTBGQlF5eERRVUZETEVWQlFVVXNRMEZCUXlKOSIsImZ1bmN0aW9uIG5vb3AoKSB7IH1cbmNvbnN0IGlkZW50aXR5ID0geCA9PiB4O1xuZnVuY3Rpb24gYXNzaWduKHRhciwgc3JjKSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGZvciAoY29uc3QgayBpbiBzcmMpXG4gICAgICAgIHRhcltrXSA9IHNyY1trXTtcbiAgICByZXR1cm4gdGFyO1xufVxuZnVuY3Rpb24gaXNfcHJvbWlzZSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHR5cGVvZiB2YWx1ZS50aGVuID09PSAnZnVuY3Rpb24nO1xufVxuZnVuY3Rpb24gYWRkX2xvY2F0aW9uKGVsZW1lbnQsIGZpbGUsIGxpbmUsIGNvbHVtbiwgY2hhcikge1xuICAgIGVsZW1lbnQuX19zdmVsdGVfbWV0YSA9IHtcbiAgICAgICAgbG9jOiB7IGZpbGUsIGxpbmUsIGNvbHVtbiwgY2hhciB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHJ1bihmbikge1xuICAgIHJldHVybiBmbigpO1xufVxuZnVuY3Rpb24gYmxhbmtfb2JqZWN0KCkge1xuICAgIHJldHVybiBPYmplY3QuY3JlYXRlKG51bGwpO1xufVxuZnVuY3Rpb24gcnVuX2FsbChmbnMpIHtcbiAgICBmbnMuZm9yRWFjaChydW4pO1xufVxuZnVuY3Rpb24gaXNfZnVuY3Rpb24odGhpbmcpIHtcbiAgICByZXR1cm4gdHlwZW9mIHRoaW5nID09PSAnZnVuY3Rpb24nO1xufVxuZnVuY3Rpb24gc2FmZV9ub3RfZXF1YWwoYSwgYikge1xuICAgIHJldHVybiBhICE9IGEgPyBiID09IGIgOiBhICE9PSBiIHx8ICgoYSAmJiB0eXBlb2YgYSA9PT0gJ29iamVjdCcpIHx8IHR5cGVvZiBhID09PSAnZnVuY3Rpb24nKTtcbn1cbmZ1bmN0aW9uIG5vdF9lcXVhbChhLCBiKSB7XG4gICAgcmV0dXJuIGEgIT0gYSA/IGIgPT0gYiA6IGEgIT09IGI7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9zdG9yZShzdG9yZSwgbmFtZSkge1xuICAgIGlmIChzdG9yZSAhPSBudWxsICYmIHR5cGVvZiBzdG9yZS5zdWJzY3JpYmUgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAnJHtuYW1lfScgaXMgbm90IGEgc3RvcmUgd2l0aCBhICdzdWJzY3JpYmUnIG1ldGhvZGApO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHN1YnNjcmliZShzdG9yZSwgLi4uY2FsbGJhY2tzKSB7XG4gICAgaWYgKHN0b3JlID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG5vb3A7XG4gICAgfVxuICAgIGNvbnN0IHVuc3ViID0gc3RvcmUuc3Vic2NyaWJlKC4uLmNhbGxiYWNrcyk7XG4gICAgcmV0dXJuIHVuc3ViLnVuc3Vic2NyaWJlID8gKCkgPT4gdW5zdWIudW5zdWJzY3JpYmUoKSA6IHVuc3ViO1xufVxuZnVuY3Rpb24gZ2V0X3N0b3JlX3ZhbHVlKHN0b3JlKSB7XG4gICAgbGV0IHZhbHVlO1xuICAgIHN1YnNjcmliZShzdG9yZSwgXyA9PiB2YWx1ZSA9IF8pKCk7XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gY29tcG9uZW50X3N1YnNjcmliZShjb21wb25lbnQsIHN0b3JlLCBjYWxsYmFjaykge1xuICAgIGNvbXBvbmVudC4kJC5vbl9kZXN0cm95LnB1c2goc3Vic2NyaWJlKHN0b3JlLCBjYWxsYmFjaykpO1xufVxuZnVuY3Rpb24gY3JlYXRlX3Nsb3QoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbikge1xuICAgIGlmIChkZWZpbml0aW9uKSB7XG4gICAgICAgIGNvbnN0IHNsb3RfY3R4ID0gZ2V0X3Nsb3RfY29udGV4dChkZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGZuKTtcbiAgICAgICAgcmV0dXJuIGRlZmluaXRpb25bMF0oc2xvdF9jdHgpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldF9zbG90X2NvbnRleHQoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbikge1xuICAgIHJldHVybiBkZWZpbml0aW9uWzFdICYmIGZuXG4gICAgICAgID8gYXNzaWduKCQkc2NvcGUuY3R4LnNsaWNlKCksIGRlZmluaXRpb25bMV0oZm4oY3R4KSkpXG4gICAgICAgIDogJCRzY29wZS5jdHg7XG59XG5mdW5jdGlvbiBnZXRfc2xvdF9jaGFuZ2VzKGRlZmluaXRpb24sICQkc2NvcGUsIGRpcnR5LCBmbikge1xuICAgIGlmIChkZWZpbml0aW9uWzJdICYmIGZuKSB7XG4gICAgICAgIGNvbnN0IGxldHMgPSBkZWZpbml0aW9uWzJdKGZuKGRpcnR5KSk7XG4gICAgICAgIGlmICh0eXBlb2YgJCRzY29wZS5kaXJ0eSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIGNvbnN0IG1lcmdlZCA9IFtdO1xuICAgICAgICAgICAgY29uc3QgbGVuID0gTWF0aC5tYXgoJCRzY29wZS5kaXJ0eS5sZW5ndGgsIGxldHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICBtZXJnZWRbaV0gPSAkJHNjb3BlLmRpcnR5W2ldIHwgbGV0c1tpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBtZXJnZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICQkc2NvcGUuZGlydHkgfCBsZXRzO1xuICAgIH1cbiAgICByZXR1cm4gJCRzY29wZS5kaXJ0eTtcbn1cbmZ1bmN0aW9uIGV4Y2x1ZGVfaW50ZXJuYWxfcHJvcHMocHJvcHMpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGsgaW4gcHJvcHMpXG4gICAgICAgIGlmIChrWzBdICE9PSAnJCcpXG4gICAgICAgICAgICByZXN1bHRba10gPSBwcm9wc1trXTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gb25jZShmbikge1xuICAgIGxldCByYW4gPSBmYWxzZTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcbiAgICAgICAgaWYgKHJhbilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgcmFuID0gdHJ1ZTtcbiAgICAgICAgZm4uY2FsbCh0aGlzLCAuLi5hcmdzKTtcbiAgICB9O1xufVxuZnVuY3Rpb24gbnVsbF90b19lbXB0eSh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PSBudWxsID8gJycgOiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIHNldF9zdG9yZV92YWx1ZShzdG9yZSwgcmV0LCB2YWx1ZSA9IHJldCkge1xuICAgIHN0b3JlLnNldCh2YWx1ZSk7XG4gICAgcmV0dXJuIHJldDtcbn1cbmNvbnN0IGhhc19wcm9wID0gKG9iaiwgcHJvcCkgPT4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCk7XG5mdW5jdGlvbiBhY3Rpb25fZGVzdHJveWVyKGFjdGlvbl9yZXN1bHQpIHtcbiAgICByZXR1cm4gYWN0aW9uX3Jlc3VsdCAmJiBpc19mdW5jdGlvbihhY3Rpb25fcmVzdWx0LmRlc3Ryb3kpID8gYWN0aW9uX3Jlc3VsdC5kZXN0cm95IDogbm9vcDtcbn1cblxuY29uc3QgaXNfY2xpZW50ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCc7XG5sZXQgbm93ID0gaXNfY2xpZW50XG4gICAgPyAoKSA9PiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KClcbiAgICA6ICgpID0+IERhdGUubm93KCk7XG5sZXQgcmFmID0gaXNfY2xpZW50ID8gY2IgPT4gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNiKSA6IG5vb3A7XG4vLyB1c2VkIGludGVybmFsbHkgZm9yIHRlc3RpbmdcbmZ1bmN0aW9uIHNldF9ub3coZm4pIHtcbiAgICBub3cgPSBmbjtcbn1cbmZ1bmN0aW9uIHNldF9yYWYoZm4pIHtcbiAgICByYWYgPSBmbjtcbn1cblxuY29uc3QgdGFza3MgPSBuZXcgU2V0KCk7XG5mdW5jdGlvbiBydW5fdGFza3Mobm93KSB7XG4gICAgdGFza3MuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgaWYgKCF0YXNrLmMobm93KSkge1xuICAgICAgICAgICAgdGFza3MuZGVsZXRlKHRhc2spO1xuICAgICAgICAgICAgdGFzay5mKCk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAodGFza3Muc2l6ZSAhPT0gMClcbiAgICAgICAgcmFmKHJ1bl90YXNrcyk7XG59XG4vKipcbiAqIEZvciB0ZXN0aW5nIHB1cnBvc2VzIG9ubHkhXG4gKi9cbmZ1bmN0aW9uIGNsZWFyX2xvb3BzKCkge1xuICAgIHRhc2tzLmNsZWFyKCk7XG59XG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgdGFzayB0aGF0IHJ1bnMgb24gZWFjaCByYWYgZnJhbWVcbiAqIHVudGlsIGl0IHJldHVybnMgYSBmYWxzeSB2YWx1ZSBvciBpcyBhYm9ydGVkXG4gKi9cbmZ1bmN0aW9uIGxvb3AoY2FsbGJhY2spIHtcbiAgICBsZXQgdGFzaztcbiAgICBpZiAodGFza3Muc2l6ZSA9PT0gMClcbiAgICAgICAgcmFmKHJ1bl90YXNrcyk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHJvbWlzZTogbmV3IFByb21pc2UoZnVsZmlsbCA9PiB7XG4gICAgICAgICAgICB0YXNrcy5hZGQodGFzayA9IHsgYzogY2FsbGJhY2ssIGY6IGZ1bGZpbGwgfSk7XG4gICAgICAgIH0pLFxuICAgICAgICBhYm9ydCgpIHtcbiAgICAgICAgICAgIHRhc2tzLmRlbGV0ZSh0YXNrKTtcbiAgICAgICAgfVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGFwcGVuZCh0YXJnZXQsIG5vZGUpIHtcbiAgICB0YXJnZXQuYXBwZW5kQ2hpbGQobm9kZSk7XG59XG5mdW5jdGlvbiBpbnNlcnQodGFyZ2V0LCBub2RlLCBhbmNob3IpIHtcbiAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKG5vZGUsIGFuY2hvciB8fCBudWxsKTtcbn1cbmZ1bmN0aW9uIGRldGFjaChub2RlKSB7XG4gICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpO1xufVxuZnVuY3Rpb24gZGVzdHJveV9lYWNoKGl0ZXJhdGlvbnMsIGRldGFjaGluZykge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlcmF0aW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBpZiAoaXRlcmF0aW9uc1tpXSlcbiAgICAgICAgICAgIGl0ZXJhdGlvbnNbaV0uZChkZXRhY2hpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGVsZW1lbnQobmFtZSkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5hbWUpO1xufVxuZnVuY3Rpb24gZWxlbWVudF9pcyhuYW1lLCBpcykge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5hbWUsIHsgaXMgfSk7XG59XG5mdW5jdGlvbiBvYmplY3Rfd2l0aG91dF9wcm9wZXJ0aWVzKG9iaiwgZXhjbHVkZSkge1xuICAgIGNvbnN0IHRhcmdldCA9IHt9O1xuICAgIGZvciAoY29uc3QgayBpbiBvYmopIHtcbiAgICAgICAgaWYgKGhhc19wcm9wKG9iaiwgaylcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICYmIGV4Y2x1ZGUuaW5kZXhPZihrKSA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHRhcmdldFtrXSA9IG9ialtrXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xufVxuZnVuY3Rpb24gc3ZnX2VsZW1lbnQobmFtZSkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgbmFtZSk7XG59XG5mdW5jdGlvbiB0ZXh0KGRhdGEpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZGF0YSk7XG59XG5mdW5jdGlvbiBzcGFjZSgpIHtcbiAgICByZXR1cm4gdGV4dCgnICcpO1xufVxuZnVuY3Rpb24gZW1wdHkoKSB7XG4gICAgcmV0dXJuIHRleHQoJycpO1xufVxuZnVuY3Rpb24gbGlzdGVuKG5vZGUsIGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKSB7XG4gICAgbm9kZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTtcbiAgICByZXR1cm4gKCkgPT4gbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTtcbn1cbmZ1bmN0aW9uIHByZXZlbnRfZGVmYXVsdChmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHN0b3BfcHJvcGFnYXRpb24oZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gc2VsZihmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSB0aGlzKVxuICAgICAgICAgICAgZm4uY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGF0dHIobm9kZSwgYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PSBudWxsKVxuICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xuICAgIGVsc2UgaWYgKG5vZGUuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSkgIT09IHZhbHVlKVxuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUsIHZhbHVlKTtcbn1cbmZ1bmN0aW9uIHNldF9hdHRyaWJ1dGVzKG5vZGUsIGF0dHJpYnV0ZXMpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY29uc3QgZGVzY3JpcHRvcnMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhub2RlLl9fcHJvdG9fXyk7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICBpZiAoYXR0cmlidXRlc1trZXldID09IG51bGwpIHtcbiAgICAgICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSAnc3R5bGUnKSB7XG4gICAgICAgICAgICBub2RlLnN0eWxlLmNzc1RleHQgPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGVzY3JpcHRvcnNba2V5XSAmJiBkZXNjcmlwdG9yc1trZXldLnNldCkge1xuICAgICAgICAgICAgbm9kZVtrZXldID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYXR0cihub2RlLCBrZXksIGF0dHJpYnV0ZXNba2V5XSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfc3ZnX2F0dHJpYnV0ZXMobm9kZSwgYXR0cmlidXRlcykge1xuICAgIGZvciAoY29uc3Qga2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgYXR0cihub2RlLCBrZXksIGF0dHJpYnV0ZXNba2V5XSk7XG4gICAgfVxufVxuZnVuY3Rpb24gc2V0X2N1c3RvbV9lbGVtZW50X2RhdGEobm9kZSwgcHJvcCwgdmFsdWUpIHtcbiAgICBpZiAocHJvcCBpbiBub2RlKSB7XG4gICAgICAgIG5vZGVbcHJvcF0gPSB2YWx1ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGF0dHIobm9kZSwgcHJvcCwgdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHhsaW5rX2F0dHIobm9kZSwgYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgIG5vZGUuc2V0QXR0cmlidXRlTlMoJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnLCBhdHRyaWJ1dGUsIHZhbHVlKTtcbn1cbmZ1bmN0aW9uIGdldF9iaW5kaW5nX2dyb3VwX3ZhbHVlKGdyb3VwKSB7XG4gICAgY29uc3QgdmFsdWUgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdyb3VwLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChncm91cFtpXS5jaGVja2VkKVxuICAgICAgICAgICAgdmFsdWUucHVzaChncm91cFtpXS5fX3ZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gdG9fbnVtYmVyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09PSAnJyA/IHVuZGVmaW5lZCA6ICt2YWx1ZTtcbn1cbmZ1bmN0aW9uIHRpbWVfcmFuZ2VzX3RvX2FycmF5KHJhbmdlcykge1xuICAgIGNvbnN0IGFycmF5ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgYXJyYXkucHVzaCh7IHN0YXJ0OiByYW5nZXMuc3RhcnQoaSksIGVuZDogcmFuZ2VzLmVuZChpKSB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5O1xufVxuZnVuY3Rpb24gY2hpbGRyZW4oZWxlbWVudCkge1xuICAgIHJldHVybiBBcnJheS5mcm9tKGVsZW1lbnQuY2hpbGROb2Rlcyk7XG59XG5mdW5jdGlvbiBjbGFpbV9lbGVtZW50KG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzLCBzdmcpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT09IG5hbWUpIHtcbiAgICAgICAgICAgIGxldCBqID0gMDtcbiAgICAgICAgICAgIHdoaWxlIChqIDwgbm9kZS5hdHRyaWJ1dGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IG5vZGUuYXR0cmlidXRlc1tqXTtcbiAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlc1thdHRyaWJ1dGUubmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBub2Rlcy5zcGxpY2UoaSwgMSlbMF07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHN2ZyA/IHN2Z19lbGVtZW50KG5hbWUpIDogZWxlbWVudChuYW1lKTtcbn1cbmZ1bmN0aW9uIGNsYWltX3RleHQobm9kZXMsIGRhdGEpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDMpIHtcbiAgICAgICAgICAgIG5vZGUuZGF0YSA9ICcnICsgZGF0YTtcbiAgICAgICAgICAgIHJldHVybiBub2Rlcy5zcGxpY2UoaSwgMSlbMF07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRleHQoZGF0YSk7XG59XG5mdW5jdGlvbiBjbGFpbV9zcGFjZShub2Rlcykge1xuICAgIHJldHVybiBjbGFpbV90ZXh0KG5vZGVzLCAnICcpO1xufVxuZnVuY3Rpb24gc2V0X2RhdGEodGV4dCwgZGF0YSkge1xuICAgIGRhdGEgPSAnJyArIGRhdGE7XG4gICAgaWYgKHRleHQuZGF0YSAhPT0gZGF0YSlcbiAgICAgICAgdGV4dC5kYXRhID0gZGF0YTtcbn1cbmZ1bmN0aW9uIHNldF9pbnB1dF92YWx1ZShpbnB1dCwgdmFsdWUpIHtcbiAgICBpZiAodmFsdWUgIT0gbnVsbCB8fCBpbnB1dC52YWx1ZSkge1xuICAgICAgICBpbnB1dC52YWx1ZSA9IHZhbHVlO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNldF9pbnB1dF90eXBlKGlucHV0LCB0eXBlKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaW5wdXQudHlwZSA9IHR5cGU7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfc3R5bGUobm9kZSwga2V5LCB2YWx1ZSwgaW1wb3J0YW50KSB7XG4gICAgbm9kZS5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHZhbHVlLCBpbXBvcnRhbnQgPyAnaW1wb3J0YW50JyA6ICcnKTtcbn1cbmZ1bmN0aW9uIHNlbGVjdF9vcHRpb24oc2VsZWN0LCB2YWx1ZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0Lm9wdGlvbnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gc2VsZWN0Lm9wdGlvbnNbaV07XG4gICAgICAgIGlmIChvcHRpb24uX192YWx1ZSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBzZWxlY3Rfb3B0aW9ucyhzZWxlY3QsIHZhbHVlKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3Qub3B0aW9ucy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBjb25zdCBvcHRpb24gPSBzZWxlY3Qub3B0aW9uc1tpXTtcbiAgICAgICAgb3B0aW9uLnNlbGVjdGVkID0gfnZhbHVlLmluZGV4T2Yob3B0aW9uLl9fdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNlbGVjdF92YWx1ZShzZWxlY3QpIHtcbiAgICBjb25zdCBzZWxlY3RlZF9vcHRpb24gPSBzZWxlY3QucXVlcnlTZWxlY3RvcignOmNoZWNrZWQnKSB8fCBzZWxlY3Qub3B0aW9uc1swXTtcbiAgICByZXR1cm4gc2VsZWN0ZWRfb3B0aW9uICYmIHNlbGVjdGVkX29wdGlvbi5fX3ZhbHVlO1xufVxuZnVuY3Rpb24gc2VsZWN0X211bHRpcGxlX3ZhbHVlKHNlbGVjdCkge1xuICAgIHJldHVybiBbXS5tYXAuY2FsbChzZWxlY3QucXVlcnlTZWxlY3RvckFsbCgnOmNoZWNrZWQnKSwgb3B0aW9uID0+IG9wdGlvbi5fX3ZhbHVlKTtcbn1cbmZ1bmN0aW9uIGFkZF9yZXNpemVfbGlzdGVuZXIoZWxlbWVudCwgZm4pIHtcbiAgICBpZiAoZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KS5wb3NpdGlvbiA9PT0gJ3N0YXRpYycpIHtcbiAgICAgICAgZWxlbWVudC5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG4gICAgfVxuICAgIGNvbnN0IG9iamVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29iamVjdCcpO1xuICAgIG9iamVjdC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ2Rpc3BsYXk6IGJsb2NrOyBwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogMDsgbGVmdDogMDsgaGVpZ2h0OiAxMDAlOyB3aWR0aDogMTAwJTsgb3ZlcmZsb3c6IGhpZGRlbjsgcG9pbnRlci1ldmVudHM6IG5vbmU7IHotaW5kZXg6IC0xOycpO1xuICAgIG9iamVjdC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKTtcbiAgICBvYmplY3QudHlwZSA9ICd0ZXh0L2h0bWwnO1xuICAgIG9iamVjdC50YWJJbmRleCA9IC0xO1xuICAgIGxldCB3aW47XG4gICAgb2JqZWN0Lm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgd2luID0gb2JqZWN0LmNvbnRlbnREb2N1bWVudC5kZWZhdWx0VmlldztcbiAgICAgICAgd2luLmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZuKTtcbiAgICB9O1xuICAgIGlmICgvVHJpZGVudC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xuICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKG9iamVjdCk7XG4gICAgICAgIG9iamVjdC5kYXRhID0gJ2Fib3V0OmJsYW5rJztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG9iamVjdC5kYXRhID0gJ2Fib3V0OmJsYW5rJztcbiAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChvYmplY3QpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBjYW5jZWw6ICgpID0+IHtcbiAgICAgICAgICAgIHdpbiAmJiB3aW4ucmVtb3ZlRXZlbnRMaXN0ZW5lciAmJiB3aW4ucmVtb3ZlRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZm4pO1xuICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDaGlsZChvYmplY3QpO1xuICAgICAgICB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRvZ2dsZV9jbGFzcyhlbGVtZW50LCBuYW1lLCB0b2dnbGUpIHtcbiAgICBlbGVtZW50LmNsYXNzTGlzdFt0b2dnbGUgPyAnYWRkJyA6ICdyZW1vdmUnXShuYW1lKTtcbn1cbmZ1bmN0aW9uIGN1c3RvbV9ldmVudCh0eXBlLCBkZXRhaWwpIHtcbiAgICBjb25zdCBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gICAgZS5pbml0Q3VzdG9tRXZlbnQodHlwZSwgZmFsc2UsIGZhbHNlLCBkZXRhaWwpO1xuICAgIHJldHVybiBlO1xufVxuZnVuY3Rpb24gcXVlcnlfc2VsZWN0b3JfYWxsKHNlbGVjdG9yLCBwYXJlbnQgPSBkb2N1bWVudC5ib2R5KSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20ocGFyZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcbn1cbmNsYXNzIEh0bWxUYWcge1xuICAgIGNvbnN0cnVjdG9yKGh0bWwsIGFuY2hvciA9IG51bGwpIHtcbiAgICAgICAgdGhpcy5lID0gZWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRoaXMuYSA9IGFuY2hvcjtcbiAgICAgICAgdGhpcy51KGh0bWwpO1xuICAgIH1cbiAgICBtKHRhcmdldCwgYW5jaG9yID0gbnVsbCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubi5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgaW5zZXJ0KHRhcmdldCwgdGhpcy5uW2ldLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudCA9IHRhcmdldDtcbiAgICB9XG4gICAgdShodG1sKSB7XG4gICAgICAgIHRoaXMuZS5pbm5lckhUTUwgPSBodG1sO1xuICAgICAgICB0aGlzLm4gPSBBcnJheS5mcm9tKHRoaXMuZS5jaGlsZE5vZGVzKTtcbiAgICB9XG4gICAgcChodG1sKSB7XG4gICAgICAgIHRoaXMuZCgpO1xuICAgICAgICB0aGlzLnUoaHRtbCk7XG4gICAgICAgIHRoaXMubSh0aGlzLnQsIHRoaXMuYSk7XG4gICAgfVxuICAgIGQoKSB7XG4gICAgICAgIHRoaXMubi5mb3JFYWNoKGRldGFjaCk7XG4gICAgfVxufVxuXG5sZXQgc3R5bGVzaGVldDtcbmxldCBhY3RpdmUgPSAwO1xubGV0IGN1cnJlbnRfcnVsZXMgPSB7fTtcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9kYXJrc2t5YXBwL3N0cmluZy1oYXNoL2Jsb2IvbWFzdGVyL2luZGV4LmpzXG5mdW5jdGlvbiBoYXNoKHN0cikge1xuICAgIGxldCBoYXNoID0gNTM4MTtcbiAgICBsZXQgaSA9IHN0ci5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSlcbiAgICAgICAgaGFzaCA9ICgoaGFzaCA8PCA1KSAtIGhhc2gpIF4gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgcmV0dXJuIGhhc2ggPj4+IDA7XG59XG5mdW5jdGlvbiBjcmVhdGVfcnVsZShub2RlLCBhLCBiLCBkdXJhdGlvbiwgZGVsYXksIGVhc2UsIGZuLCB1aWQgPSAwKSB7XG4gICAgY29uc3Qgc3RlcCA9IDE2LjY2NiAvIGR1cmF0aW9uO1xuICAgIGxldCBrZXlmcmFtZXMgPSAne1xcbic7XG4gICAgZm9yIChsZXQgcCA9IDA7IHAgPD0gMTsgcCArPSBzdGVwKSB7XG4gICAgICAgIGNvbnN0IHQgPSBhICsgKGIgLSBhKSAqIGVhc2UocCk7XG4gICAgICAgIGtleWZyYW1lcyArPSBwICogMTAwICsgYCV7JHtmbih0LCAxIC0gdCl9fVxcbmA7XG4gICAgfVxuICAgIGNvbnN0IHJ1bGUgPSBrZXlmcmFtZXMgKyBgMTAwJSB7JHtmbihiLCAxIC0gYil9fVxcbn1gO1xuICAgIGNvbnN0IG5hbWUgPSBgX19zdmVsdGVfJHtoYXNoKHJ1bGUpfV8ke3VpZH1gO1xuICAgIGlmICghY3VycmVudF9ydWxlc1tuYW1lXSkge1xuICAgICAgICBpZiAoIXN0eWxlc2hlZXQpIHtcbiAgICAgICAgICAgIGNvbnN0IHN0eWxlID0gZWxlbWVudCgnc3R5bGUnKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuICAgICAgICAgICAgc3R5bGVzaGVldCA9IHN0eWxlLnNoZWV0O1xuICAgICAgICB9XG4gICAgICAgIGN1cnJlbnRfcnVsZXNbbmFtZV0gPSB0cnVlO1xuICAgICAgICBzdHlsZXNoZWV0Lmluc2VydFJ1bGUoYEBrZXlmcmFtZXMgJHtuYW1lfSAke3J1bGV9YCwgc3R5bGVzaGVldC5jc3NSdWxlcy5sZW5ndGgpO1xuICAgIH1cbiAgICBjb25zdCBhbmltYXRpb24gPSBub2RlLnN0eWxlLmFuaW1hdGlvbiB8fCAnJztcbiAgICBub2RlLnN0eWxlLmFuaW1hdGlvbiA9IGAke2FuaW1hdGlvbiA/IGAke2FuaW1hdGlvbn0sIGAgOiBgYH0ke25hbWV9ICR7ZHVyYXRpb259bXMgbGluZWFyICR7ZGVsYXl9bXMgMSBib3RoYDtcbiAgICBhY3RpdmUgKz0gMTtcbiAgICByZXR1cm4gbmFtZTtcbn1cbmZ1bmN0aW9uIGRlbGV0ZV9ydWxlKG5vZGUsIG5hbWUpIHtcbiAgICBub2RlLnN0eWxlLmFuaW1hdGlvbiA9IChub2RlLnN0eWxlLmFuaW1hdGlvbiB8fCAnJylcbiAgICAgICAgLnNwbGl0KCcsICcpXG4gICAgICAgIC5maWx0ZXIobmFtZVxuICAgICAgICA/IGFuaW0gPT4gYW5pbS5pbmRleE9mKG5hbWUpIDwgMCAvLyByZW1vdmUgc3BlY2lmaWMgYW5pbWF0aW9uXG4gICAgICAgIDogYW5pbSA9PiBhbmltLmluZGV4T2YoJ19fc3ZlbHRlJykgPT09IC0xIC8vIHJlbW92ZSBhbGwgU3ZlbHRlIGFuaW1hdGlvbnNcbiAgICApXG4gICAgICAgIC5qb2luKCcsICcpO1xuICAgIGlmIChuYW1lICYmICEtLWFjdGl2ZSlcbiAgICAgICAgY2xlYXJfcnVsZXMoKTtcbn1cbmZ1bmN0aW9uIGNsZWFyX3J1bGVzKCkge1xuICAgIHJhZigoKSA9PiB7XG4gICAgICAgIGlmIChhY3RpdmUpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGxldCBpID0gc3R5bGVzaGVldC5jc3NSdWxlcy5sZW5ndGg7XG4gICAgICAgIHdoaWxlIChpLS0pXG4gICAgICAgICAgICBzdHlsZXNoZWV0LmRlbGV0ZVJ1bGUoaSk7XG4gICAgICAgIGN1cnJlbnRfcnVsZXMgPSB7fTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlX2FuaW1hdGlvbihub2RlLCBmcm9tLCBmbiwgcGFyYW1zKSB7XG4gICAgaWYgKCFmcm9tKVxuICAgICAgICByZXR1cm4gbm9vcDtcbiAgICBjb25zdCB0byA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgaWYgKGZyb20ubGVmdCA9PT0gdG8ubGVmdCAmJiBmcm9tLnJpZ2h0ID09PSB0by5yaWdodCAmJiBmcm9tLnRvcCA9PT0gdG8udG9wICYmIGZyb20uYm90dG9tID09PSB0by5ib3R0b20pXG4gICAgICAgIHJldHVybiBub29wO1xuICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIFxuICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogc2hvdWxkIHRoaXMgYmUgc2VwYXJhdGVkIGZyb20gZGVzdHJ1Y3R1cmluZz8gT3Igc3RhcnQvZW5kIGFkZGVkIHRvIHB1YmxpYyBhcGkgYW5kIGRvY3VtZW50YXRpb24/XG4gICAgc3RhcnQ6IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5LCBcbiAgICAvLyBAdHMtaWdub3JlIHRvZG86XG4gICAgZW5kID0gc3RhcnRfdGltZSArIGR1cmF0aW9uLCB0aWNrID0gbm9vcCwgY3NzIH0gPSBmbihub2RlLCB7IGZyb20sIHRvIH0sIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSB0cnVlO1xuICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgbGV0IG5hbWU7XG4gICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgICAgIG5hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAwLCAxLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRlbGF5KSB7XG4gICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgbmFtZSk7XG4gICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgbG9vcChub3cgPT4ge1xuICAgICAgICBpZiAoIXN0YXJ0ZWQgJiYgbm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGFydGVkICYmIG5vdyA+PSBlbmQpIHtcbiAgICAgICAgICAgIHRpY2soMSwgMCk7XG4gICAgICAgICAgICBzdG9wKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFydW5uaW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHAgPSBub3cgLSBzdGFydF90aW1lO1xuICAgICAgICAgICAgY29uc3QgdCA9IDAgKyAxICogZWFzaW5nKHAgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9KTtcbiAgICBzdGFydCgpO1xuICAgIHRpY2soMCwgMSk7XG4gICAgcmV0dXJuIHN0b3A7XG59XG5mdW5jdGlvbiBmaXhfcG9zaXRpb24obm9kZSkge1xuICAgIGNvbnN0IHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICBpZiAoc3R5bGUucG9zaXRpb24gIT09ICdhYnNvbHV0ZScgJiYgc3R5bGUucG9zaXRpb24gIT09ICdmaXhlZCcpIHtcbiAgICAgICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSBzdHlsZTtcbiAgICAgICAgY29uc3QgYSA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgICBub2RlLnN0eWxlLndpZHRoID0gd2lkdGg7XG4gICAgICAgIG5vZGUuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICBhZGRfdHJhbnNmb3JtKG5vZGUsIGEpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFkZF90cmFuc2Zvcm0obm9kZSwgYSkge1xuICAgIGNvbnN0IGIgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGlmIChhLmxlZnQgIT09IGIubGVmdCB8fCBhLnRvcCAhPT0gYi50b3ApIHtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICAgICAgICBjb25zdCB0cmFuc2Zvcm0gPSBzdHlsZS50cmFuc2Zvcm0gPT09ICdub25lJyA/ICcnIDogc3R5bGUudHJhbnNmb3JtO1xuICAgICAgICBub2RlLnN0eWxlLnRyYW5zZm9ybSA9IGAke3RyYW5zZm9ybX0gdHJhbnNsYXRlKCR7YS5sZWZ0IC0gYi5sZWZ0fXB4LCAke2EudG9wIC0gYi50b3B9cHgpYDtcbiAgICB9XG59XG5cbmxldCBjdXJyZW50X2NvbXBvbmVudDtcbmZ1bmN0aW9uIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpIHtcbiAgICBjdXJyZW50X2NvbXBvbmVudCA9IGNvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGdldF9jdXJyZW50X2NvbXBvbmVudCgpIHtcbiAgICBpZiAoIWN1cnJlbnRfY29tcG9uZW50KVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZ1bmN0aW9uIGNhbGxlZCBvdXRzaWRlIGNvbXBvbmVudCBpbml0aWFsaXphdGlvbmApO1xuICAgIHJldHVybiBjdXJyZW50X2NvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGJlZm9yZVVwZGF0ZShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmJlZm9yZV91cGRhdGUucHVzaChmbik7XG59XG5mdW5jdGlvbiBvbk1vdW50KGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQub25fbW91bnQucHVzaChmbik7XG59XG5mdW5jdGlvbiBhZnRlclVwZGF0ZShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmFmdGVyX3VwZGF0ZS5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIG9uRGVzdHJveShmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLm9uX2Rlc3Ryb3kucHVzaChmbik7XG59XG5mdW5jdGlvbiBjcmVhdGVFdmVudERpc3BhdGNoZXIoKSB7XG4gICAgY29uc3QgY29tcG9uZW50ID0gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCk7XG4gICAgcmV0dXJuICh0eXBlLCBkZXRhaWwpID0+IHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gY29tcG9uZW50LiQkLmNhbGxiYWNrc1t0eXBlXTtcbiAgICAgICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICAgICAgLy8gVE9ETyBhcmUgdGhlcmUgc2l0dWF0aW9ucyB3aGVyZSBldmVudHMgY291bGQgYmUgZGlzcGF0Y2hlZFxuICAgICAgICAgICAgLy8gaW4gYSBzZXJ2ZXIgKG5vbi1ET00pIGVudmlyb25tZW50P1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBjdXN0b21fZXZlbnQodHlwZSwgZGV0YWlsKTtcbiAgICAgICAgICAgIGNhbGxiYWNrcy5zbGljZSgpLmZvckVhY2goZm4gPT4ge1xuICAgICAgICAgICAgICAgIGZuLmNhbGwoY29tcG9uZW50LCBldmVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiBzZXRDb250ZXh0KGtleSwgY29udGV4dCkge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQuc2V0KGtleSwgY29udGV4dCk7XG59XG5mdW5jdGlvbiBnZXRDb250ZXh0KGtleSkge1xuICAgIHJldHVybiBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0LmdldChrZXkpO1xufVxuLy8gVE9ETyBmaWd1cmUgb3V0IGlmIHdlIHN0aWxsIHdhbnQgdG8gc3VwcG9ydFxuLy8gc2hvcnRoYW5kIGV2ZW50cywgb3IgaWYgd2Ugd2FudCB0byBpbXBsZW1lbnRcbi8vIGEgcmVhbCBidWJibGluZyBtZWNoYW5pc21cbmZ1bmN0aW9uIGJ1YmJsZShjb21wb25lbnQsIGV2ZW50KSB7XG4gICAgY29uc3QgY2FsbGJhY2tzID0gY29tcG9uZW50LiQkLmNhbGxiYWNrc1tldmVudC50eXBlXTtcbiAgICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgICAgIGNhbGxiYWNrcy5zbGljZSgpLmZvckVhY2goZm4gPT4gZm4oZXZlbnQpKTtcbiAgICB9XG59XG5cbmNvbnN0IGRpcnR5X2NvbXBvbmVudHMgPSBbXTtcbmNvbnN0IGludHJvcyA9IHsgZW5hYmxlZDogZmFsc2UgfTtcbmNvbnN0IGJpbmRpbmdfY2FsbGJhY2tzID0gW107XG5jb25zdCByZW5kZXJfY2FsbGJhY2tzID0gW107XG5jb25zdCBmbHVzaF9jYWxsYmFja3MgPSBbXTtcbmNvbnN0IHJlc29sdmVkX3Byb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTtcbmxldCB1cGRhdGVfc2NoZWR1bGVkID0gZmFsc2U7XG5mdW5jdGlvbiBzY2hlZHVsZV91cGRhdGUoKSB7XG4gICAgaWYgKCF1cGRhdGVfc2NoZWR1bGVkKSB7XG4gICAgICAgIHVwZGF0ZV9zY2hlZHVsZWQgPSB0cnVlO1xuICAgICAgICByZXNvbHZlZF9wcm9taXNlLnRoZW4oZmx1c2gpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHRpY2soKSB7XG4gICAgc2NoZWR1bGVfdXBkYXRlKCk7XG4gICAgcmV0dXJuIHJlc29sdmVkX3Byb21pc2U7XG59XG5mdW5jdGlvbiBhZGRfcmVuZGVyX2NhbGxiYWNrKGZuKSB7XG4gICAgcmVuZGVyX2NhbGxiYWNrcy5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIGFkZF9mbHVzaF9jYWxsYmFjayhmbikge1xuICAgIGZsdXNoX2NhbGxiYWNrcy5wdXNoKGZuKTtcbn1cbmNvbnN0IHNlZW5fY2FsbGJhY2tzID0gbmV3IFNldCgpO1xuZnVuY3Rpb24gZmx1c2goKSB7XG4gICAgZG8ge1xuICAgICAgICAvLyBmaXJzdCwgY2FsbCBiZWZvcmVVcGRhdGUgZnVuY3Rpb25zXG4gICAgICAgIC8vIGFuZCB1cGRhdGUgY29tcG9uZW50c1xuICAgICAgICB3aGlsZSAoZGlydHlfY29tcG9uZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGRpcnR5X2NvbXBvbmVudHMuc2hpZnQoKTtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpO1xuICAgICAgICAgICAgdXBkYXRlKGNvbXBvbmVudC4kJCk7XG4gICAgICAgIH1cbiAgICAgICAgd2hpbGUgKGJpbmRpbmdfY2FsbGJhY2tzLmxlbmd0aClcbiAgICAgICAgICAgIGJpbmRpbmdfY2FsbGJhY2tzLnBvcCgpKCk7XG4gICAgICAgIC8vIHRoZW4sIG9uY2UgY29tcG9uZW50cyBhcmUgdXBkYXRlZCwgY2FsbFxuICAgICAgICAvLyBhZnRlclVwZGF0ZSBmdW5jdGlvbnMuIFRoaXMgbWF5IGNhdXNlXG4gICAgICAgIC8vIHN1YnNlcXVlbnQgdXBkYXRlcy4uLlxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlbmRlcl9jYWxsYmFja3MubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrID0gcmVuZGVyX2NhbGxiYWNrc1tpXTtcbiAgICAgICAgICAgIGlmICghc2Vlbl9jYWxsYmFja3MuaGFzKGNhbGxiYWNrKSkge1xuICAgICAgICAgICAgICAgIC8vIC4uLnNvIGd1YXJkIGFnYWluc3QgaW5maW5pdGUgbG9vcHNcbiAgICAgICAgICAgICAgICBzZWVuX2NhbGxiYWNrcy5hZGQoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVuZGVyX2NhbGxiYWNrcy5sZW5ndGggPSAwO1xuICAgIH0gd2hpbGUgKGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoKTtcbiAgICB3aGlsZSAoZmx1c2hfY2FsbGJhY2tzLmxlbmd0aCkge1xuICAgICAgICBmbHVzaF9jYWxsYmFja3MucG9wKCkoKTtcbiAgICB9XG4gICAgdXBkYXRlX3NjaGVkdWxlZCA9IGZhbHNlO1xuICAgIHNlZW5fY2FsbGJhY2tzLmNsZWFyKCk7XG59XG5mdW5jdGlvbiB1cGRhdGUoJCQpIHtcbiAgICBpZiAoJCQuZnJhZ21lbnQgIT09IG51bGwpIHtcbiAgICAgICAgJCQudXBkYXRlKCk7XG4gICAgICAgIHJ1bl9hbGwoJCQuYmVmb3JlX3VwZGF0ZSk7XG4gICAgICAgIGNvbnN0IGRpcnR5ID0gJCQuZGlydHk7XG4gICAgICAgICQkLmRpcnR5ID0gWy0xXTtcbiAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQucCgkJC5jdHgsIGRpcnR5KTtcbiAgICAgICAgJCQuYWZ0ZXJfdXBkYXRlLmZvckVhY2goYWRkX3JlbmRlcl9jYWxsYmFjayk7XG4gICAgfVxufVxuXG5sZXQgcHJvbWlzZTtcbmZ1bmN0aW9uIHdhaXQoKSB7XG4gICAgaWYgKCFwcm9taXNlKSB7XG4gICAgICAgIHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgcHJvbWlzZS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHByb21pc2UgPSBudWxsO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHByb21pc2U7XG59XG5mdW5jdGlvbiBkaXNwYXRjaChub2RlLCBkaXJlY3Rpb24sIGtpbmQpIHtcbiAgICBub2RlLmRpc3BhdGNoRXZlbnQoY3VzdG9tX2V2ZW50KGAke2RpcmVjdGlvbiA/ICdpbnRybycgOiAnb3V0cm8nfSR7a2luZH1gKSk7XG59XG5jb25zdCBvdXRyb2luZyA9IG5ldyBTZXQoKTtcbmxldCBvdXRyb3M7XG5mdW5jdGlvbiBncm91cF9vdXRyb3MoKSB7XG4gICAgb3V0cm9zID0ge1xuICAgICAgICByOiAwLFxuICAgICAgICBjOiBbXSxcbiAgICAgICAgcDogb3V0cm9zIC8vIHBhcmVudCBncm91cFxuICAgIH07XG59XG5mdW5jdGlvbiBjaGVja19vdXRyb3MoKSB7XG4gICAgaWYgKCFvdXRyb3Mucikge1xuICAgICAgICBydW5fYWxsKG91dHJvcy5jKTtcbiAgICB9XG4gICAgb3V0cm9zID0gb3V0cm9zLnA7XG59XG5mdW5jdGlvbiB0cmFuc2l0aW9uX2luKGJsb2NrLCBsb2NhbCkge1xuICAgIGlmIChibG9jayAmJiBibG9jay5pKSB7XG4gICAgICAgIG91dHJvaW5nLmRlbGV0ZShibG9jayk7XG4gICAgICAgIGJsb2NrLmkobG9jYWwpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHRyYW5zaXRpb25fb3V0KGJsb2NrLCBsb2NhbCwgZGV0YWNoLCBjYWxsYmFjaykge1xuICAgIGlmIChibG9jayAmJiBibG9jay5vKSB7XG4gICAgICAgIGlmIChvdXRyb2luZy5oYXMoYmxvY2spKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBvdXRyb2luZy5hZGQoYmxvY2spO1xuICAgICAgICBvdXRyb3MuYy5wdXNoKCgpID0+IHtcbiAgICAgICAgICAgIG91dHJvaW5nLmRlbGV0ZShibG9jayk7XG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICBpZiAoZGV0YWNoKVxuICAgICAgICAgICAgICAgICAgICBibG9jay5kKDEpO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBibG9jay5vKGxvY2FsKTtcbiAgICB9XG59XG5jb25zdCBudWxsX3RyYW5zaXRpb24gPSB7IGR1cmF0aW9uOiAwIH07XG5mdW5jdGlvbiBjcmVhdGVfaW5fdHJhbnNpdGlvbihub2RlLCBmbiwgcGFyYW1zKSB7XG4gICAgbGV0IGNvbmZpZyA9IGZuKG5vZGUsIHBhcmFtcyk7XG4gICAgbGV0IHJ1bm5pbmcgPSBmYWxzZTtcbiAgICBsZXQgYW5pbWF0aW9uX25hbWU7XG4gICAgbGV0IHRhc2s7XG4gICAgbGV0IHVpZCA9IDA7XG4gICAgZnVuY3Rpb24gY2xlYW51cCgpIHtcbiAgICAgICAgaWYgKGFuaW1hdGlvbl9uYW1lKVxuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgYW5pbWF0aW9uX25hbWUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnbygpIHtcbiAgICAgICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgdGljayA9IG5vb3AsIGNzcyB9ID0gY29uZmlnIHx8IG51bGxfdHJhbnNpdGlvbjtcbiAgICAgICAgaWYgKGNzcylcbiAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgMCwgMSwgZHVyYXRpb24sIGRlbGF5LCBlYXNpbmcsIGNzcywgdWlkKyspO1xuICAgICAgICB0aWNrKDAsIDEpO1xuICAgICAgICBjb25zdCBzdGFydF90aW1lID0gbm93KCkgKyBkZWxheTtcbiAgICAgICAgY29uc3QgZW5kX3RpbWUgPSBzdGFydF90aW1lICsgZHVyYXRpb247XG4gICAgICAgIGlmICh0YXNrKVxuICAgICAgICAgICAgdGFzay5hYm9ydCgpO1xuICAgICAgICBydW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiBkaXNwYXRjaChub2RlLCB0cnVlLCAnc3RhcnQnKSk7XG4gICAgICAgIHRhc2sgPSBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gZW5kX3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGljaygxLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgdHJ1ZSwgJ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gc3RhcnRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZWFzaW5nKChub3cgLSBzdGFydF90aW1lKSAvIGR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdGljayh0LCAxIC0gdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJ1bm5pbmc7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBsZXQgc3RhcnRlZCA9IGZhbHNlO1xuICAgIHJldHVybiB7XG4gICAgICAgIHN0YXJ0KCkge1xuICAgICAgICAgICAgaWYgKHN0YXJ0ZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSk7XG4gICAgICAgICAgICBpZiAoaXNfZnVuY3Rpb24oY29uZmlnKSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZyA9IGNvbmZpZygpO1xuICAgICAgICAgICAgICAgIHdhaXQoKS50aGVuKGdvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGdvKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGludmFsaWRhdGUoKSB7XG4gICAgICAgICAgICBzdGFydGVkID0gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVuZCgpIHtcbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiBjcmVhdGVfb3V0X3RyYW5zaXRpb24obm9kZSwgZm4sIHBhcmFtcykge1xuICAgIGxldCBjb25maWcgPSBmbihub2RlLCBwYXJhbXMpO1xuICAgIGxldCBydW5uaW5nID0gdHJ1ZTtcbiAgICBsZXQgYW5pbWF0aW9uX25hbWU7XG4gICAgY29uc3QgZ3JvdXAgPSBvdXRyb3M7XG4gICAgZ3JvdXAuciArPSAxO1xuICAgIGZ1bmN0aW9uIGdvKCkge1xuICAgICAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCB0aWNrID0gbm9vcCwgY3NzIH0gPSBjb25maWcgfHwgbnVsbF90cmFuc2l0aW9uO1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAxLCAwLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgY29uc3Qgc3RhcnRfdGltZSA9IG5vdygpICsgZGVsYXk7XG4gICAgICAgIGNvbnN0IGVuZF90aW1lID0gc3RhcnRfdGltZSArIGR1cmF0aW9uO1xuICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IGRpc3BhdGNoKG5vZGUsIGZhbHNlLCAnc3RhcnQnKSk7XG4gICAgICAgIGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBlbmRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICB0aWNrKDAsIDEpO1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCBmYWxzZSwgJ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIS0tZ3JvdXAucikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyB3aWxsIHJlc3VsdCBpbiBgZW5kKClgIGJlaW5nIGNhbGxlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvIHdlIGRvbid0IG5lZWQgdG8gY2xlYW4gdXAgaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgcnVuX2FsbChncm91cC5jKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gc3RhcnRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZWFzaW5nKChub3cgLSBzdGFydF90aW1lKSAvIGR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdGljaygxIC0gdCwgdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJ1bm5pbmc7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoaXNfZnVuY3Rpb24oY29uZmlnKSkge1xuICAgICAgICB3YWl0KCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICBjb25maWcgPSBjb25maWcoKTtcbiAgICAgICAgICAgIGdvKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZ28oKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZW5kKHJlc2V0KSB7XG4gICAgICAgICAgICBpZiAocmVzZXQgJiYgY29uZmlnLnRpY2spIHtcbiAgICAgICAgICAgICAgICBjb25maWcudGljaygxLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9uYW1lKVxuICAgICAgICAgICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBhbmltYXRpb25fbmFtZSk7XG4gICAgICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9iaWRpcmVjdGlvbmFsX3RyYW5zaXRpb24obm9kZSwgZm4sIHBhcmFtcywgaW50cm8pIHtcbiAgICBsZXQgY29uZmlnID0gZm4obm9kZSwgcGFyYW1zKTtcbiAgICBsZXQgdCA9IGludHJvID8gMCA6IDE7XG4gICAgbGV0IHJ1bm5pbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgbGV0IHBlbmRpbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgbGV0IGFuaW1hdGlvbl9uYW1lID0gbnVsbDtcbiAgICBmdW5jdGlvbiBjbGVhcl9hbmltYXRpb24oKSB7XG4gICAgICAgIGlmIChhbmltYXRpb25fbmFtZSlcbiAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUsIGFuaW1hdGlvbl9uYW1lKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaW5pdChwcm9ncmFtLCBkdXJhdGlvbikge1xuICAgICAgICBjb25zdCBkID0gcHJvZ3JhbS5iIC0gdDtcbiAgICAgICAgZHVyYXRpb24gKj0gTWF0aC5hYnMoZCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhOiB0LFxuICAgICAgICAgICAgYjogcHJvZ3JhbS5iLFxuICAgICAgICAgICAgZCxcbiAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgc3RhcnQ6IHByb2dyYW0uc3RhcnQsXG4gICAgICAgICAgICBlbmQ6IHByb2dyYW0uc3RhcnQgKyBkdXJhdGlvbixcbiAgICAgICAgICAgIGdyb3VwOiBwcm9ncmFtLmdyb3VwXG4gICAgICAgIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdvKGIpIHtcbiAgICAgICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgdGljayA9IG5vb3AsIGNzcyB9ID0gY29uZmlnIHx8IG51bGxfdHJhbnNpdGlvbjtcbiAgICAgICAgY29uc3QgcHJvZ3JhbSA9IHtcbiAgICAgICAgICAgIHN0YXJ0OiBub3coKSArIGRlbGF5LFxuICAgICAgICAgICAgYlxuICAgICAgICB9O1xuICAgICAgICBpZiAoIWIpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogaW1wcm92ZSB0eXBpbmdzXG4gICAgICAgICAgICBwcm9ncmFtLmdyb3VwID0gb3V0cm9zO1xuICAgICAgICAgICAgb3V0cm9zLnIgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocnVubmluZ19wcm9ncmFtKSB7XG4gICAgICAgICAgICBwZW5kaW5nX3Byb2dyYW0gPSBwcm9ncmFtO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhbiBpbnRybywgYW5kIHRoZXJlJ3MgYSBkZWxheSwgd2UgbmVlZCB0byBkb1xuICAgICAgICAgICAgLy8gYW4gaW5pdGlhbCB0aWNrIGFuZC9vciBhcHBseSBDU1MgYW5pbWF0aW9uIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICBpZiAoY3NzKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCB0LCBiLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChiKVxuICAgICAgICAgICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBpbml0KHByb2dyYW0sIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4gZGlzcGF0Y2gobm9kZSwgYiwgJ3N0YXJ0JykpO1xuICAgICAgICAgICAgbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nX3Byb2dyYW0gJiYgbm93ID4gcGVuZGluZ19wcm9ncmFtLnN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IGluaXQocGVuZGluZ19wcm9ncmFtLCBkdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHBlbmRpbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIHJ1bm5pbmdfcHJvZ3JhbS5iLCAnc3RhcnQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIHQsIHJ1bm5pbmdfcHJvZ3JhbS5iLCBydW5uaW5nX3Byb2dyYW0uZHVyYXRpb24sIDAsIGVhc2luZywgY29uZmlnLmNzcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm93ID49IHJ1bm5pbmdfcHJvZ3JhbS5lbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2sodCA9IHJ1bm5pbmdfcHJvZ3JhbS5iLCAxIC0gdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCBydW5uaW5nX3Byb2dyYW0uYiwgJ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwZW5kaW5nX3Byb2dyYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSdyZSBkb25lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbS5iKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGludHJvIOKAlCB3ZSBjYW4gdGlkeSB1cCBpbW1lZGlhdGVseVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG91dHJvIOKAlCBuZWVkcyB0byBiZSBjb29yZGluYXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIS0tcnVubmluZ19wcm9ncmFtLmdyb3VwLnIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydW5fYWxsKHJ1bm5pbmdfcHJvZ3JhbS5ncm91cC5jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG5vdyA+PSBydW5uaW5nX3Byb2dyYW0uc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHAgPSBub3cgLSBydW5uaW5nX3Byb2dyYW0uc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0gcnVubmluZ19wcm9ncmFtLmEgKyBydW5uaW5nX3Byb2dyYW0uZCAqIGVhc2luZyhwIC8gcnVubmluZ19wcm9ncmFtLmR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2sodCwgMSAtIHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAhIShydW5uaW5nX3Byb2dyYW0gfHwgcGVuZGluZ19wcm9ncmFtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHJ1bihiKSB7XG4gICAgICAgICAgICBpZiAoaXNfZnVuY3Rpb24oY29uZmlnKSkge1xuICAgICAgICAgICAgICAgIHdhaXQoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBjb25maWcgPSBjb25maWcoKTtcbiAgICAgICAgICAgICAgICAgICAgZ28oYik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBnbyhiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW5kKCkge1xuICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBwZW5kaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlX3Byb21pc2UocHJvbWlzZSwgaW5mbykge1xuICAgIGNvbnN0IHRva2VuID0gaW5mby50b2tlbiA9IHt9O1xuICAgIGZ1bmN0aW9uIHVwZGF0ZSh0eXBlLCBpbmRleCwga2V5LCB2YWx1ZSkge1xuICAgICAgICBpZiAoaW5mby50b2tlbiAhPT0gdG9rZW4pXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGluZm8ucmVzb2x2ZWQgPSB2YWx1ZTtcbiAgICAgICAgbGV0IGNoaWxkX2N0eCA9IGluZm8uY3R4O1xuICAgICAgICBpZiAoa2V5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNoaWxkX2N0eCA9IGNoaWxkX2N0eC5zbGljZSgpO1xuICAgICAgICAgICAgY2hpbGRfY3R4W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBibG9jayA9IHR5cGUgJiYgKGluZm8uY3VycmVudCA9IHR5cGUpKGNoaWxkX2N0eCk7XG4gICAgICAgIGxldCBuZWVkc19mbHVzaCA9IGZhbHNlO1xuICAgICAgICBpZiAoaW5mby5ibG9jaykge1xuICAgICAgICAgICAgaWYgKGluZm8uYmxvY2tzKSB7XG4gICAgICAgICAgICAgICAgaW5mby5ibG9ja3MuZm9yRWFjaCgoYmxvY2ssIGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT09IGluZGV4ICYmIGJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cF9vdXRyb3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb25fb3V0KGJsb2NrLCAxLCAxLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mby5ibG9ja3NbaV0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja19vdXRyb3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5mby5ibG9jay5kKDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suYygpO1xuICAgICAgICAgICAgdHJhbnNpdGlvbl9pbihibG9jaywgMSk7XG4gICAgICAgICAgICBibG9jay5tKGluZm8ubW91bnQoKSwgaW5mby5hbmNob3IpO1xuICAgICAgICAgICAgbmVlZHNfZmx1c2ggPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGluZm8uYmxvY2sgPSBibG9jaztcbiAgICAgICAgaWYgKGluZm8uYmxvY2tzKVxuICAgICAgICAgICAgaW5mby5ibG9ja3NbaW5kZXhdID0gYmxvY2s7XG4gICAgICAgIGlmIChuZWVkc19mbHVzaCkge1xuICAgICAgICAgICAgZmx1c2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoaXNfcHJvbWlzZShwcm9taXNlKSkge1xuICAgICAgICBjb25zdCBjdXJyZW50X2NvbXBvbmVudCA9IGdldF9jdXJyZW50X2NvbXBvbmVudCgpO1xuICAgICAgICBwcm9taXNlLnRoZW4odmFsdWUgPT4ge1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGN1cnJlbnRfY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnRoZW4sIDEsIGluZm8udmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChudWxsKTtcbiAgICAgICAgfSwgZXJyb3IgPT4ge1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGN1cnJlbnRfY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLmNhdGNoLCAyLCBpbmZvLmVycm9yLCBlcnJvcik7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBpZiB3ZSBwcmV2aW91c2x5IGhhZCBhIHRoZW4vY2F0Y2ggYmxvY2ssIGRlc3Ryb3kgaXRcbiAgICAgICAgaWYgKGluZm8uY3VycmVudCAhPT0gaW5mby5wZW5kaW5nKSB7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby5wZW5kaW5nLCAwKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoaW5mby5jdXJyZW50ICE9PSBpbmZvLnRoZW4pIHtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnRoZW4sIDEsIGluZm8udmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaW5mby5yZXNvbHZlZCA9IHByb21pc2U7XG4gICAgfVxufVxuXG5jb25zdCBnbG9iYWxzID0gKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogZ2xvYmFsKTtcblxuZnVuY3Rpb24gZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgYmxvY2suZCgxKTtcbiAgICBsb29rdXAuZGVsZXRlKGJsb2NrLmtleSk7XG59XG5mdW5jdGlvbiBvdXRyb19hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgdHJhbnNpdGlvbl9vdXQoYmxvY2ssIDEsIDEsICgpID0+IHtcbiAgICAgICAgbG9va3VwLmRlbGV0ZShibG9jay5rZXkpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZml4X2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICBibG9jay5mKCk7XG4gICAgZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKTtcbn1cbmZ1bmN0aW9uIGZpeF9hbmRfb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIGJsb2NrLmYoKTtcbiAgICBvdXRyb19hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZV9rZXllZF9lYWNoKG9sZF9ibG9ja3MsIGRpcnR5LCBnZXRfa2V5LCBkeW5hbWljLCBjdHgsIGxpc3QsIGxvb2t1cCwgbm9kZSwgZGVzdHJveSwgY3JlYXRlX2VhY2hfYmxvY2ssIG5leHQsIGdldF9jb250ZXh0KSB7XG4gICAgbGV0IG8gPSBvbGRfYmxvY2tzLmxlbmd0aDtcbiAgICBsZXQgbiA9IGxpc3QubGVuZ3RoO1xuICAgIGxldCBpID0gbztcbiAgICBjb25zdCBvbGRfaW5kZXhlcyA9IHt9O1xuICAgIHdoaWxlIChpLS0pXG4gICAgICAgIG9sZF9pbmRleGVzW29sZF9ibG9ja3NbaV0ua2V5XSA9IGk7XG4gICAgY29uc3QgbmV3X2Jsb2NrcyA9IFtdO1xuICAgIGNvbnN0IG5ld19sb29rdXAgPSBuZXcgTWFwKCk7XG4gICAgY29uc3QgZGVsdGFzID0gbmV3IE1hcCgpO1xuICAgIGkgPSBuO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY29uc3QgY2hpbGRfY3R4ID0gZ2V0X2NvbnRleHQoY3R4LCBsaXN0LCBpKTtcbiAgICAgICAgY29uc3Qga2V5ID0gZ2V0X2tleShjaGlsZF9jdHgpO1xuICAgICAgICBsZXQgYmxvY2sgPSBsb29rdXAuZ2V0KGtleSk7XG4gICAgICAgIGlmICghYmxvY2spIHtcbiAgICAgICAgICAgIGJsb2NrID0gY3JlYXRlX2VhY2hfYmxvY2soa2V5LCBjaGlsZF9jdHgpO1xuICAgICAgICAgICAgYmxvY2suYygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGR5bmFtaWMpIHtcbiAgICAgICAgICAgIGJsb2NrLnAoY2hpbGRfY3R4LCBkaXJ0eSk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3X2xvb2t1cC5zZXQoa2V5LCBuZXdfYmxvY2tzW2ldID0gYmxvY2spO1xuICAgICAgICBpZiAoa2V5IGluIG9sZF9pbmRleGVzKVxuICAgICAgICAgICAgZGVsdGFzLnNldChrZXksIE1hdGguYWJzKGkgLSBvbGRfaW5kZXhlc1trZXldKSk7XG4gICAgfVxuICAgIGNvbnN0IHdpbGxfbW92ZSA9IG5ldyBTZXQoKTtcbiAgICBjb25zdCBkaWRfbW92ZSA9IG5ldyBTZXQoKTtcbiAgICBmdW5jdGlvbiBpbnNlcnQoYmxvY2spIHtcbiAgICAgICAgdHJhbnNpdGlvbl9pbihibG9jaywgMSk7XG4gICAgICAgIGJsb2NrLm0obm9kZSwgbmV4dCk7XG4gICAgICAgIGxvb2t1cC5zZXQoYmxvY2sua2V5LCBibG9jayk7XG4gICAgICAgIG5leHQgPSBibG9jay5maXJzdDtcbiAgICAgICAgbi0tO1xuICAgIH1cbiAgICB3aGlsZSAobyAmJiBuKSB7XG4gICAgICAgIGNvbnN0IG5ld19ibG9jayA9IG5ld19ibG9ja3NbbiAtIDFdO1xuICAgICAgICBjb25zdCBvbGRfYmxvY2sgPSBvbGRfYmxvY2tzW28gLSAxXTtcbiAgICAgICAgY29uc3QgbmV3X2tleSA9IG5ld19ibG9jay5rZXk7XG4gICAgICAgIGNvbnN0IG9sZF9rZXkgPSBvbGRfYmxvY2sua2V5O1xuICAgICAgICBpZiAobmV3X2Jsb2NrID09PSBvbGRfYmxvY2spIHtcbiAgICAgICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICAgICAgICAgIG5leHQgPSBuZXdfYmxvY2suZmlyc3Q7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgICAgICBuLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIW5ld19sb29rdXAuaGFzKG9sZF9rZXkpKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgb2xkIGJsb2NrXG4gICAgICAgICAgICBkZXN0cm95KG9sZF9ibG9jaywgbG9va3VwKTtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghbG9va3VwLmhhcyhuZXdfa2V5KSB8fCB3aWxsX21vdmUuaGFzKG5ld19rZXkpKSB7XG4gICAgICAgICAgICBpbnNlcnQobmV3X2Jsb2NrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkaWRfbW92ZS5oYXMob2xkX2tleSkpIHtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkZWx0YXMuZ2V0KG5ld19rZXkpID4gZGVsdGFzLmdldChvbGRfa2V5KSkge1xuICAgICAgICAgICAgZGlkX21vdmUuYWRkKG5ld19rZXkpO1xuICAgICAgICAgICAgaW5zZXJ0KG5ld19ibG9jayk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB3aWxsX21vdmUuYWRkKG9sZF9rZXkpO1xuICAgICAgICAgICAgby0tO1xuICAgICAgICB9XG4gICAgfVxuICAgIHdoaWxlIChvLS0pIHtcbiAgICAgICAgY29uc3Qgb2xkX2Jsb2NrID0gb2xkX2Jsb2Nrc1tvXTtcbiAgICAgICAgaWYgKCFuZXdfbG9va3VwLmhhcyhvbGRfYmxvY2sua2V5KSlcbiAgICAgICAgICAgIGRlc3Ryb3kob2xkX2Jsb2NrLCBsb29rdXApO1xuICAgIH1cbiAgICB3aGlsZSAobilcbiAgICAgICAgaW5zZXJ0KG5ld19ibG9ja3NbbiAtIDFdKTtcbiAgICByZXR1cm4gbmV3X2Jsb2Nrcztcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX2VhY2hfa2V5cyhjdHgsIGxpc3QsIGdldF9jb250ZXh0LCBnZXRfa2V5KSB7XG4gICAgY29uc3Qga2V5cyA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qga2V5ID0gZ2V0X2tleShnZXRfY29udGV4dChjdHgsIGxpc3QsIGkpKTtcbiAgICAgICAgaWYgKGtleXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGhhdmUgZHVwbGljYXRlIGtleXMgaW4gYSBrZXllZCBlYWNoYCk7XG4gICAgICAgIH1cbiAgICAgICAga2V5cy5hZGQoa2V5KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldF9zcHJlYWRfdXBkYXRlKGxldmVscywgdXBkYXRlcykge1xuICAgIGNvbnN0IHVwZGF0ZSA9IHt9O1xuICAgIGNvbnN0IHRvX251bGxfb3V0ID0ge307XG4gICAgY29uc3QgYWNjb3VudGVkX2ZvciA9IHsgJCRzY29wZTogMSB9O1xuICAgIGxldCBpID0gbGV2ZWxzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbnN0IG8gPSBsZXZlbHNbaV07XG4gICAgICAgIGNvbnN0IG4gPSB1cGRhdGVzW2ldO1xuICAgICAgICBpZiAobikge1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbykge1xuICAgICAgICAgICAgICAgIGlmICghKGtleSBpbiBuKSlcbiAgICAgICAgICAgICAgICAgICAgdG9fbnVsbF9vdXRba2V5XSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBuKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhY2NvdW50ZWRfZm9yW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlW2tleV0gPSBuW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRlZF9mb3Jba2V5XSA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV2ZWxzW2ldID0gbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG8pIHtcbiAgICAgICAgICAgICAgICBhY2NvdW50ZWRfZm9yW2tleV0gPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZvciAoY29uc3Qga2V5IGluIHRvX251bGxfb3V0KSB7XG4gICAgICAgIGlmICghKGtleSBpbiB1cGRhdGUpKVxuICAgICAgICAgICAgdXBkYXRlW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiB1cGRhdGU7XG59XG5mdW5jdGlvbiBnZXRfc3ByZWFkX29iamVjdChzcHJlYWRfcHJvcHMpIHtcbiAgICByZXR1cm4gdHlwZW9mIHNwcmVhZF9wcm9wcyA9PT0gJ29iamVjdCcgJiYgc3ByZWFkX3Byb3BzICE9PSBudWxsID8gc3ByZWFkX3Byb3BzIDoge307XG59XG5cbi8vIHNvdXJjZTogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvaW5kaWNlcy5odG1sXG5jb25zdCBib29sZWFuX2F0dHJpYnV0ZXMgPSBuZXcgU2V0KFtcbiAgICAnYWxsb3dmdWxsc2NyZWVuJyxcbiAgICAnYWxsb3dwYXltZW50cmVxdWVzdCcsXG4gICAgJ2FzeW5jJyxcbiAgICAnYXV0b2ZvY3VzJyxcbiAgICAnYXV0b3BsYXknLFxuICAgICdjaGVja2VkJyxcbiAgICAnY29udHJvbHMnLFxuICAgICdkZWZhdWx0JyxcbiAgICAnZGVmZXInLFxuICAgICdkaXNhYmxlZCcsXG4gICAgJ2Zvcm1ub3ZhbGlkYXRlJyxcbiAgICAnaGlkZGVuJyxcbiAgICAnaXNtYXAnLFxuICAgICdsb29wJyxcbiAgICAnbXVsdGlwbGUnLFxuICAgICdtdXRlZCcsXG4gICAgJ25vbW9kdWxlJyxcbiAgICAnbm92YWxpZGF0ZScsXG4gICAgJ29wZW4nLFxuICAgICdwbGF5c2lubGluZScsXG4gICAgJ3JlYWRvbmx5JyxcbiAgICAncmVxdWlyZWQnLFxuICAgICdyZXZlcnNlZCcsXG4gICAgJ3NlbGVjdGVkJ1xuXSk7XG5cbmNvbnN0IGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyID0gL1tcXHMnXCI+Lz1cXHV7RkREMH0tXFx1e0ZERUZ9XFx1e0ZGRkV9XFx1e0ZGRkZ9XFx1ezFGRkZFfVxcdXsxRkZGRn1cXHV7MkZGRkV9XFx1ezJGRkZGfVxcdXszRkZGRX1cXHV7M0ZGRkZ9XFx1ezRGRkZFfVxcdXs0RkZGRn1cXHV7NUZGRkV9XFx1ezVGRkZGfVxcdXs2RkZGRX1cXHV7NkZGRkZ9XFx1ezdGRkZFfVxcdXs3RkZGRn1cXHV7OEZGRkV9XFx1ezhGRkZGfVxcdXs5RkZGRX1cXHV7OUZGRkZ9XFx1e0FGRkZFfVxcdXtBRkZGRn1cXHV7QkZGRkV9XFx1e0JGRkZGfVxcdXtDRkZGRX1cXHV7Q0ZGRkZ9XFx1e0RGRkZFfVxcdXtERkZGRn1cXHV7RUZGRkV9XFx1e0VGRkZGfVxcdXtGRkZGRX1cXHV7RkZGRkZ9XFx1ezEwRkZGRX1cXHV7MTBGRkZGfV0vdTtcbi8vIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL3N5bnRheC5odG1sI2F0dHJpYnV0ZXMtMlxuLy8gaHR0cHM6Ly9pbmZyYS5zcGVjLndoYXR3Zy5vcmcvI25vbmNoYXJhY3RlclxuZnVuY3Rpb24gc3ByZWFkKGFyZ3MsIGNsYXNzZXNfdG9fYWRkKSB7XG4gICAgY29uc3QgYXR0cmlidXRlcyA9IE9iamVjdC5hc3NpZ24oe30sIC4uLmFyZ3MpO1xuICAgIGlmIChjbGFzc2VzX3RvX2FkZCkge1xuICAgICAgICBpZiAoYXR0cmlidXRlcy5jbGFzcyA9PSBudWxsKSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzID0gY2xhc3Nlc190b19hZGQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzICs9ICcgJyArIGNsYXNzZXNfdG9fYWRkO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxldCBzdHIgPSAnJztcbiAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKG5hbWUgPT4ge1xuICAgICAgICBpZiAoaW52YWxpZF9hdHRyaWJ1dGVfbmFtZV9jaGFyYWN0ZXIudGVzdChuYW1lKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBhdHRyaWJ1dGVzW25hbWVdO1xuICAgICAgICBpZiAodmFsdWUgPT09IHRydWUpXG4gICAgICAgICAgICBzdHIgKz0gXCIgXCIgKyBuYW1lO1xuICAgICAgICBlbHNlIGlmIChib29sZWFuX2F0dHJpYnV0ZXMuaGFzKG5hbWUudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSlcbiAgICAgICAgICAgICAgICBzdHIgKz0gXCIgXCIgKyBuYW1lO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHN0ciArPSBgICR7bmFtZX09XCIke1N0cmluZyh2YWx1ZSkucmVwbGFjZSgvXCIvZywgJyYjMzQ7JykucmVwbGFjZSgvJy9nLCAnJiMzOTsnKX1cImA7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gc3RyO1xufVxuY29uc3QgZXNjYXBlZCA9IHtcbiAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICBcIidcIjogJyYjMzk7JyxcbiAgICAnJic6ICcmYW1wOycsXG4gICAgJzwnOiAnJmx0OycsXG4gICAgJz4nOiAnJmd0Oydcbn07XG5mdW5jdGlvbiBlc2NhcGUoaHRtbCkge1xuICAgIHJldHVybiBTdHJpbmcoaHRtbCkucmVwbGFjZSgvW1wiJyY8Pl0vZywgbWF0Y2ggPT4gZXNjYXBlZFttYXRjaF0pO1xufVxuZnVuY3Rpb24gZWFjaChpdGVtcywgZm4pIHtcbiAgICBsZXQgc3RyID0gJyc7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBzdHIgKz0gZm4oaXRlbXNbaV0sIGkpO1xuICAgIH1cbiAgICByZXR1cm4gc3RyO1xufVxuY29uc3QgbWlzc2luZ19jb21wb25lbnQgPSB7XG4gICAgJCRyZW5kZXI6ICgpID0+ICcnXG59O1xuZnVuY3Rpb24gdmFsaWRhdGVfY29tcG9uZW50KGNvbXBvbmVudCwgbmFtZSkge1xuICAgIGlmICghY29tcG9uZW50IHx8ICFjb21wb25lbnQuJCRyZW5kZXIpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09ICdzdmVsdGU6Y29tcG9uZW50JylcbiAgICAgICAgICAgIG5hbWUgKz0gJyB0aGlzPXsuLi59JztcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGA8JHtuYW1lfT4gaXMgbm90IGEgdmFsaWQgU1NSIGNvbXBvbmVudC4gWW91IG1heSBuZWVkIHRvIHJldmlldyB5b3VyIGJ1aWxkIGNvbmZpZyB0byBlbnN1cmUgdGhhdCBkZXBlbmRlbmNpZXMgYXJlIGNvbXBpbGVkLCByYXRoZXIgdGhhbiBpbXBvcnRlZCBhcyBwcmUtY29tcGlsZWQgbW9kdWxlc2ApO1xuICAgIH1cbiAgICByZXR1cm4gY29tcG9uZW50O1xufVxuZnVuY3Rpb24gZGVidWcoZmlsZSwgbGluZSwgY29sdW1uLCB2YWx1ZXMpIHtcbiAgICBjb25zb2xlLmxvZyhge0BkZWJ1Z30gJHtmaWxlID8gZmlsZSArICcgJyA6ICcnfSgke2xpbmV9OiR7Y29sdW1ufSlgKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS5sb2codmFsdWVzKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgcmV0dXJuICcnO1xufVxubGV0IG9uX2Rlc3Ryb3k7XG5mdW5jdGlvbiBjcmVhdGVfc3NyX2NvbXBvbmVudChmbikge1xuICAgIGZ1bmN0aW9uICQkcmVuZGVyKHJlc3VsdCwgcHJvcHMsIGJpbmRpbmdzLCBzbG90cykge1xuICAgICAgICBjb25zdCBwYXJlbnRfY29tcG9uZW50ID0gY3VycmVudF9jb21wb25lbnQ7XG4gICAgICAgIGNvbnN0ICQkID0ge1xuICAgICAgICAgICAgb25fZGVzdHJveSxcbiAgICAgICAgICAgIGNvbnRleHQ6IG5ldyBNYXAocGFyZW50X2NvbXBvbmVudCA/IHBhcmVudF9jb21wb25lbnQuJCQuY29udGV4dCA6IFtdKSxcbiAgICAgICAgICAgIC8vIHRoZXNlIHdpbGwgYmUgaW1tZWRpYXRlbHkgZGlzY2FyZGVkXG4gICAgICAgICAgICBvbl9tb3VudDogW10sXG4gICAgICAgICAgICBiZWZvcmVfdXBkYXRlOiBbXSxcbiAgICAgICAgICAgIGFmdGVyX3VwZGF0ZTogW10sXG4gICAgICAgICAgICBjYWxsYmFja3M6IGJsYW5rX29iamVjdCgpXG4gICAgICAgIH07XG4gICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudCh7ICQkIH0pO1xuICAgICAgICBjb25zdCBodG1sID0gZm4ocmVzdWx0LCBwcm9wcywgYmluZGluZ3MsIHNsb3RzKTtcbiAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHBhcmVudF9jb21wb25lbnQpO1xuICAgICAgICByZXR1cm4gaHRtbDtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVuZGVyOiAocHJvcHMgPSB7fSwgb3B0aW9ucyA9IHt9KSA9PiB7XG4gICAgICAgICAgICBvbl9kZXN0cm95ID0gW107XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7IHRpdGxlOiAnJywgaGVhZDogJycsIGNzczogbmV3IFNldCgpIH07XG4gICAgICAgICAgICBjb25zdCBodG1sID0gJCRyZW5kZXIocmVzdWx0LCBwcm9wcywge30sIG9wdGlvbnMpO1xuICAgICAgICAgICAgcnVuX2FsbChvbl9kZXN0cm95KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaHRtbCxcbiAgICAgICAgICAgICAgICBjc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgY29kZTogQXJyYXkuZnJvbShyZXN1bHQuY3NzKS5tYXAoY3NzID0+IGNzcy5jb2RlKS5qb2luKCdcXG4nKSxcbiAgICAgICAgICAgICAgICAgICAgbWFwOiBudWxsIC8vIFRPRE9cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGhlYWQ6IHJlc3VsdC50aXRsZSArIHJlc3VsdC5oZWFkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICAkJHJlbmRlclxuICAgIH07XG59XG5mdW5jdGlvbiBhZGRfYXR0cmlidXRlKG5hbWUsIHZhbHVlLCBib29sZWFuKSB7XG4gICAgaWYgKHZhbHVlID09IG51bGwgfHwgKGJvb2xlYW4gJiYgIXZhbHVlKSlcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIHJldHVybiBgICR7bmFtZX0ke3ZhbHVlID09PSB0cnVlID8gJycgOiBgPSR7dHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IEpTT04uc3RyaW5naWZ5KGVzY2FwZSh2YWx1ZSkpIDogYFwiJHt2YWx1ZX1cImB9YH1gO1xufVxuZnVuY3Rpb24gYWRkX2NsYXNzZXMoY2xhc3Nlcykge1xuICAgIHJldHVybiBjbGFzc2VzID8gYCBjbGFzcz1cIiR7Y2xhc3Nlc31cImAgOiBgYDtcbn1cblxuZnVuY3Rpb24gYmluZChjb21wb25lbnQsIG5hbWUsIGNhbGxiYWNrKSB7XG4gICAgY29uc3QgaW5kZXggPSBjb21wb25lbnQuJCQucHJvcHNbbmFtZV07XG4gICAgaWYgKGluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29tcG9uZW50LiQkLmJvdW5kW2luZGV4XSA9IGNhbGxiYWNrO1xuICAgICAgICBjYWxsYmFjayhjb21wb25lbnQuJCQuY3R4W2luZGV4XSk7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlX2NvbXBvbmVudChibG9jaykge1xuICAgIGJsb2NrICYmIGJsb2NrLmMoKTtcbn1cbmZ1bmN0aW9uIGNsYWltX2NvbXBvbmVudChibG9jaywgcGFyZW50X25vZGVzKSB7XG4gICAgYmxvY2sgJiYgYmxvY2subChwYXJlbnRfbm9kZXMpO1xufVxuZnVuY3Rpb24gbW91bnRfY29tcG9uZW50KGNvbXBvbmVudCwgdGFyZ2V0LCBhbmNob3IpIHtcbiAgICBjb25zdCB7IGZyYWdtZW50LCBvbl9tb3VudCwgb25fZGVzdHJveSwgYWZ0ZXJfdXBkYXRlIH0gPSBjb21wb25lbnQuJCQ7XG4gICAgZnJhZ21lbnQgJiYgZnJhZ21lbnQubSh0YXJnZXQsIGFuY2hvcik7XG4gICAgLy8gb25Nb3VudCBoYXBwZW5zIGJlZm9yZSB0aGUgaW5pdGlhbCBhZnRlclVwZGF0ZVxuICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4ge1xuICAgICAgICBjb25zdCBuZXdfb25fZGVzdHJveSA9IG9uX21vdW50Lm1hcChydW4pLmZpbHRlcihpc19mdW5jdGlvbik7XG4gICAgICAgIGlmIChvbl9kZXN0cm95KSB7XG4gICAgICAgICAgICBvbl9kZXN0cm95LnB1c2goLi4ubmV3X29uX2Rlc3Ryb3kpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gRWRnZSBjYXNlIC0gY29tcG9uZW50IHdhcyBkZXN0cm95ZWQgaW1tZWRpYXRlbHksXG4gICAgICAgICAgICAvLyBtb3N0IGxpa2VseSBhcyBhIHJlc3VsdCBvZiBhIGJpbmRpbmcgaW5pdGlhbGlzaW5nXG4gICAgICAgICAgICBydW5fYWxsKG5ld19vbl9kZXN0cm95KTtcbiAgICAgICAgfVxuICAgICAgICBjb21wb25lbnQuJCQub25fbW91bnQgPSBbXTtcbiAgICB9KTtcbiAgICBhZnRlcl91cGRhdGUuZm9yRWFjaChhZGRfcmVuZGVyX2NhbGxiYWNrKTtcbn1cbmZ1bmN0aW9uIGRlc3Ryb3lfY29tcG9uZW50KGNvbXBvbmVudCwgZGV0YWNoaW5nKSB7XG4gICAgY29uc3QgJCQgPSBjb21wb25lbnQuJCQ7XG4gICAgaWYgKCQkLmZyYWdtZW50ICE9PSBudWxsKSB7XG4gICAgICAgIHJ1bl9hbGwoJCQub25fZGVzdHJveSk7XG4gICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50LmQoZGV0YWNoaW5nKTtcbiAgICAgICAgLy8gVE9ETyBudWxsIG91dCBvdGhlciByZWZzLCBpbmNsdWRpbmcgY29tcG9uZW50LiQkIChidXQgbmVlZCB0b1xuICAgICAgICAvLyBwcmVzZXJ2ZSBmaW5hbCBzdGF0ZT8pXG4gICAgICAgICQkLm9uX2Rlc3Ryb3kgPSAkJC5mcmFnbWVudCA9IG51bGw7XG4gICAgICAgICQkLmN0eCA9IFtdO1xuICAgIH1cbn1cbmZ1bmN0aW9uIG1ha2VfZGlydHkoY29tcG9uZW50LCBpKSB7XG4gICAgaWYgKGNvbXBvbmVudC4kJC5kaXJ0eVswXSA9PT0gLTEpIHtcbiAgICAgICAgZGlydHlfY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XG4gICAgICAgIHNjaGVkdWxlX3VwZGF0ZSgpO1xuICAgICAgICBjb21wb25lbnQuJCQuZGlydHkuZmlsbCgwKTtcbiAgICB9XG4gICAgY29tcG9uZW50LiQkLmRpcnR5WyhpIC8gMzEpIHwgMF0gfD0gKDEgPDwgKGkgJSAzMSkpO1xufVxuZnVuY3Rpb24gaW5pdChjb21wb25lbnQsIG9wdGlvbnMsIGluc3RhbmNlLCBjcmVhdGVfZnJhZ21lbnQsIG5vdF9lcXVhbCwgcHJvcHMsIGRpcnR5ID0gWy0xXSkge1xuICAgIGNvbnN0IHBhcmVudF9jb21wb25lbnQgPSBjdXJyZW50X2NvbXBvbmVudDtcbiAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY29tcG9uZW50KTtcbiAgICBjb25zdCBwcm9wX3ZhbHVlcyA9IG9wdGlvbnMucHJvcHMgfHwge307XG4gICAgY29uc3QgJCQgPSBjb21wb25lbnQuJCQgPSB7XG4gICAgICAgIGZyYWdtZW50OiBudWxsLFxuICAgICAgICBjdHg6IG51bGwsXG4gICAgICAgIC8vIHN0YXRlXG4gICAgICAgIHByb3BzLFxuICAgICAgICB1cGRhdGU6IG5vb3AsXG4gICAgICAgIG5vdF9lcXVhbCxcbiAgICAgICAgYm91bmQ6IGJsYW5rX29iamVjdCgpLFxuICAgICAgICAvLyBsaWZlY3ljbGVcbiAgICAgICAgb25fbW91bnQ6IFtdLFxuICAgICAgICBvbl9kZXN0cm95OiBbXSxcbiAgICAgICAgYmVmb3JlX3VwZGF0ZTogW10sXG4gICAgICAgIGFmdGVyX3VwZGF0ZTogW10sXG4gICAgICAgIGNvbnRleHQ6IG5ldyBNYXAocGFyZW50X2NvbXBvbmVudCA/IHBhcmVudF9jb21wb25lbnQuJCQuY29udGV4dCA6IFtdKSxcbiAgICAgICAgLy8gZXZlcnl0aGluZyBlbHNlXG4gICAgICAgIGNhbGxiYWNrczogYmxhbmtfb2JqZWN0KCksXG4gICAgICAgIGRpcnR5XG4gICAgfTtcbiAgICBsZXQgcmVhZHkgPSBmYWxzZTtcbiAgICAkJC5jdHggPSBpbnN0YW5jZVxuICAgICAgICA/IGluc3RhbmNlKGNvbXBvbmVudCwgcHJvcF92YWx1ZXMsIChpLCByZXQsIC4uLnJlc3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gcmVzdC5sZW5ndGggPyByZXN0WzBdIDogcmV0O1xuICAgICAgICAgICAgaWYgKCQkLmN0eCAmJiBub3RfZXF1YWwoJCQuY3R4W2ldLCAkJC5jdHhbaV0gPSB2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoJCQuYm91bmRbaV0pXG4gICAgICAgICAgICAgICAgICAgICQkLmJvdW5kW2ldKHZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVhZHkpXG4gICAgICAgICAgICAgICAgICAgIG1ha2VfZGlydHkoY29tcG9uZW50LCBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgIH0pXG4gICAgICAgIDogW107XG4gICAgJCQudXBkYXRlKCk7XG4gICAgcmVhZHkgPSB0cnVlO1xuICAgIHJ1bl9hbGwoJCQuYmVmb3JlX3VwZGF0ZSk7XG4gICAgLy8gYGZhbHNlYCBhcyBhIHNwZWNpYWwgY2FzZSBvZiBubyBET00gY29tcG9uZW50XG4gICAgJCQuZnJhZ21lbnQgPSBjcmVhdGVfZnJhZ21lbnQgPyBjcmVhdGVfZnJhZ21lbnQoJCQuY3R4KSA6IGZhbHNlO1xuICAgIGlmIChvcHRpb25zLnRhcmdldCkge1xuICAgICAgICBpZiAob3B0aW9ucy5oeWRyYXRlKSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQubChjaGlsZHJlbihvcHRpb25zLnRhcmdldCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb25cbiAgICAgICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50LmMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucy5pbnRybylcbiAgICAgICAgICAgIHRyYW5zaXRpb25faW4oY29tcG9uZW50LiQkLmZyYWdtZW50KTtcbiAgICAgICAgbW91bnRfY29tcG9uZW50KGNvbXBvbmVudCwgb3B0aW9ucy50YXJnZXQsIG9wdGlvbnMuYW5jaG9yKTtcbiAgICAgICAgZmx1c2goKTtcbiAgICB9XG4gICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHBhcmVudF9jb21wb25lbnQpO1xufVxubGV0IFN2ZWx0ZUVsZW1lbnQ7XG5pZiAodHlwZW9mIEhUTUxFbGVtZW50ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgU3ZlbHRlRWxlbWVudCA9IGNsYXNzIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIHN1cGVyKCk7XG4gICAgICAgICAgICB0aGlzLmF0dGFjaFNoYWRvdyh7IG1vZGU6ICdvcGVuJyB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogaW1wcm92ZSB0eXBpbmdzXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLiQkLnNsb3R0ZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIHRvZG86IGltcHJvdmUgdHlwaW5nc1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kQ2hpbGQodGhpcy4kJC5zbG90dGVkW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayhhdHRyLCBfb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzW2F0dHJdID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgJGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBkZXN0cm95X2NvbXBvbmVudCh0aGlzLCAxKTtcbiAgICAgICAgICAgIHRoaXMuJGRlc3Ryb3kgPSBub29wO1xuICAgICAgICB9XG4gICAgICAgICRvbih0eXBlLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgLy8gVE9ETyBzaG91bGQgdGhpcyBkZWxlZ2F0ZSB0byBhZGRFdmVudExpc3RlbmVyP1xuICAgICAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdIHx8ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSA9IFtdKSk7XG4gICAgICAgICAgICBjYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gY2FsbGJhY2tzLmluZGV4T2YoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICAkc2V0KCkge1xuICAgICAgICAgICAgLy8gb3ZlcnJpZGRlbiBieSBpbnN0YW5jZSwgaWYgaXQgaGFzIHByb3BzXG4gICAgICAgIH1cbiAgICB9O1xufVxuY2xhc3MgU3ZlbHRlQ29tcG9uZW50IHtcbiAgICAkZGVzdHJveSgpIHtcbiAgICAgICAgZGVzdHJveV9jb21wb25lbnQodGhpcywgMSk7XG4gICAgICAgIHRoaXMuJGRlc3Ryb3kgPSBub29wO1xuICAgIH1cbiAgICAkb24odHlwZSwgY2FsbGJhY2spIHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdIHx8ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSA9IFtdKSk7XG4gICAgICAgIGNhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gY2FsbGJhY2tzLmluZGV4T2YoY2FsbGJhY2spO1xuICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSlcbiAgICAgICAgICAgICAgICBjYWxsYmFja3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgJHNldCgpIHtcbiAgICAgICAgLy8gb3ZlcnJpZGRlbiBieSBpbnN0YW5jZSwgaWYgaXQgaGFzIHByb3BzXG4gICAgfVxufVxuXG5mdW5jdGlvbiBkaXNwYXRjaF9kZXYodHlwZSwgZGV0YWlsKSB7XG4gICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChjdXN0b21fZXZlbnQodHlwZSwgT2JqZWN0LmFzc2lnbih7IHZlcnNpb246ICczLjE4LjEnIH0sIGRldGFpbCkpKTtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9kZXYodGFyZ2V0LCBub2RlKSB7XG4gICAgZGlzcGF0Y2hfZGV2KFwiU3ZlbHRlRE9NSW5zZXJ0XCIsIHsgdGFyZ2V0LCBub2RlIH0pO1xuICAgIGFwcGVuZCh0YXJnZXQsIG5vZGUpO1xufVxuZnVuY3Rpb24gaW5zZXJ0X2Rldih0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIGRpc3BhdGNoX2RldihcIlN2ZWx0ZURPTUluc2VydFwiLCB7IHRhcmdldCwgbm9kZSwgYW5jaG9yIH0pO1xuICAgIGluc2VydCh0YXJnZXQsIG5vZGUsIGFuY2hvcik7XG59XG5mdW5jdGlvbiBkZXRhY2hfZGV2KG5vZGUpIHtcbiAgICBkaXNwYXRjaF9kZXYoXCJTdmVsdGVET01SZW1vdmVcIiwgeyBub2RlIH0pO1xuICAgIGRldGFjaChub2RlKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9iZXR3ZWVuX2RldihiZWZvcmUsIGFmdGVyKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZyAmJiBiZWZvcmUubmV4dFNpYmxpbmcgIT09IGFmdGVyKSB7XG4gICAgICAgIGRldGFjaF9kZXYoYmVmb3JlLm5leHRTaWJsaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkZXRhY2hfYmVmb3JlX2RldihhZnRlcikge1xuICAgIHdoaWxlIChhZnRlci5wcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgICAgZGV0YWNoX2RldihhZnRlci5wcmV2aW91c1NpYmxpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRldGFjaF9hZnRlcl9kZXYoYmVmb3JlKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZykge1xuICAgICAgICBkZXRhY2hfZGV2KGJlZm9yZS5uZXh0U2libGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbGlzdGVuX2Rldihub2RlLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucywgaGFzX3ByZXZlbnRfZGVmYXVsdCwgaGFzX3N0b3BfcHJvcGFnYXRpb24pIHtcbiAgICBjb25zdCBtb2RpZmllcnMgPSBvcHRpb25zID09PSB0cnVlID8gW1wiY2FwdHVyZVwiXSA6IG9wdGlvbnMgPyBBcnJheS5mcm9tKE9iamVjdC5rZXlzKG9wdGlvbnMpKSA6IFtdO1xuICAgIGlmIChoYXNfcHJldmVudF9kZWZhdWx0KVxuICAgICAgICBtb2RpZmllcnMucHVzaCgncHJldmVudERlZmF1bHQnKTtcbiAgICBpZiAoaGFzX3N0b3BfcHJvcGFnYXRpb24pXG4gICAgICAgIG1vZGlmaWVycy5wdXNoKCdzdG9wUHJvcGFnYXRpb24nKTtcbiAgICBkaXNwYXRjaF9kZXYoXCJTdmVsdGVET01BZGRFdmVudExpc3RlbmVyXCIsIHsgbm9kZSwgZXZlbnQsIGhhbmRsZXIsIG1vZGlmaWVycyB9KTtcbiAgICBjb25zdCBkaXNwb3NlID0gbGlzdGVuKG5vZGUsIGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBkaXNwYXRjaF9kZXYoXCJTdmVsdGVET01SZW1vdmVFdmVudExpc3RlbmVyXCIsIHsgbm9kZSwgZXZlbnQsIGhhbmRsZXIsIG1vZGlmaWVycyB9KTtcbiAgICAgICAgZGlzcG9zZSgpO1xuICAgIH07XG59XG5mdW5jdGlvbiBhdHRyX2Rldihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKTtcbiAgICBpZiAodmFsdWUgPT0gbnVsbClcbiAgICAgICAgZGlzcGF0Y2hfZGV2KFwiU3ZlbHRlRE9NUmVtb3ZlQXR0cmlidXRlXCIsIHsgbm9kZSwgYXR0cmlidXRlIH0pO1xuICAgIGVsc2VcbiAgICAgICAgZGlzcGF0Y2hfZGV2KFwiU3ZlbHRlRE9NU2V0QXR0cmlidXRlXCIsIHsgbm9kZSwgYXR0cmlidXRlLCB2YWx1ZSB9KTtcbn1cbmZ1bmN0aW9uIHByb3BfZGV2KG5vZGUsIHByb3BlcnR5LCB2YWx1ZSkge1xuICAgIG5vZGVbcHJvcGVydHldID0gdmFsdWU7XG4gICAgZGlzcGF0Y2hfZGV2KFwiU3ZlbHRlRE9NU2V0UHJvcGVydHlcIiwgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBkYXRhc2V0X2Rldihub2RlLCBwcm9wZXJ0eSwgdmFsdWUpIHtcbiAgICBub2RlLmRhdGFzZXRbcHJvcGVydHldID0gdmFsdWU7XG4gICAgZGlzcGF0Y2hfZGV2KFwiU3ZlbHRlRE9NU2V0RGF0YXNldFwiLCB7IG5vZGUsIHByb3BlcnR5LCB2YWx1ZSB9KTtcbn1cbmZ1bmN0aW9uIHNldF9kYXRhX2Rldih0ZXh0LCBkYXRhKSB7XG4gICAgZGF0YSA9ICcnICsgZGF0YTtcbiAgICBpZiAodGV4dC5kYXRhID09PSBkYXRhKVxuICAgICAgICByZXR1cm47XG4gICAgZGlzcGF0Y2hfZGV2KFwiU3ZlbHRlRE9NU2V0RGF0YVwiLCB7IG5vZGU6IHRleHQsIGRhdGEgfSk7XG4gICAgdGV4dC5kYXRhID0gZGF0YTtcbn1cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudERldiBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICBpZiAoIW9wdGlvbnMgfHwgKCFvcHRpb25zLnRhcmdldCAmJiAhb3B0aW9ucy4kJGlubGluZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgJ3RhcmdldCcgaXMgYSByZXF1aXJlZCBvcHRpb25gKTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlcigpO1xuICAgIH1cbiAgICAkZGVzdHJveSgpIHtcbiAgICAgICAgc3VwZXIuJGRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy4kZGVzdHJveSA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgQ29tcG9uZW50IHdhcyBhbHJlYWR5IGRlc3Ryb3llZGApOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgfTtcbiAgICB9XG59XG5mdW5jdGlvbiBsb29wX2d1YXJkKHRpbWVvdXQpIHtcbiAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgaWYgKERhdGUubm93KCkgLSBzdGFydCA+IHRpbWVvdXQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW5maW5pdGUgbG9vcCBkZXRlY3RlZGApO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZXhwb3J0IHsgSHRtbFRhZywgU3ZlbHRlQ29tcG9uZW50LCBTdmVsdGVDb21wb25lbnREZXYsIFN2ZWx0ZUVsZW1lbnQsIGFjdGlvbl9kZXN0cm95ZXIsIGFkZF9hdHRyaWJ1dGUsIGFkZF9jbGFzc2VzLCBhZGRfZmx1c2hfY2FsbGJhY2ssIGFkZF9sb2NhdGlvbiwgYWRkX3JlbmRlcl9jYWxsYmFjaywgYWRkX3Jlc2l6ZV9saXN0ZW5lciwgYWRkX3RyYW5zZm9ybSwgYWZ0ZXJVcGRhdGUsIGFwcGVuZCwgYXBwZW5kX2RldiwgYXNzaWduLCBhdHRyLCBhdHRyX2RldiwgYmVmb3JlVXBkYXRlLCBiaW5kLCBiaW5kaW5nX2NhbGxiYWNrcywgYmxhbmtfb2JqZWN0LCBidWJibGUsIGNoZWNrX291dHJvcywgY2hpbGRyZW4sIGNsYWltX2NvbXBvbmVudCwgY2xhaW1fZWxlbWVudCwgY2xhaW1fc3BhY2UsIGNsYWltX3RleHQsIGNsZWFyX2xvb3BzLCBjb21wb25lbnRfc3Vic2NyaWJlLCBjcmVhdGVFdmVudERpc3BhdGNoZXIsIGNyZWF0ZV9hbmltYXRpb24sIGNyZWF0ZV9iaWRpcmVjdGlvbmFsX3RyYW5zaXRpb24sIGNyZWF0ZV9jb21wb25lbnQsIGNyZWF0ZV9pbl90cmFuc2l0aW9uLCBjcmVhdGVfb3V0X3RyYW5zaXRpb24sIGNyZWF0ZV9zbG90LCBjcmVhdGVfc3NyX2NvbXBvbmVudCwgY3VycmVudF9jb21wb25lbnQsIGN1c3RvbV9ldmVudCwgZGF0YXNldF9kZXYsIGRlYnVnLCBkZXN0cm95X2Jsb2NrLCBkZXN0cm95X2NvbXBvbmVudCwgZGVzdHJveV9lYWNoLCBkZXRhY2gsIGRldGFjaF9hZnRlcl9kZXYsIGRldGFjaF9iZWZvcmVfZGV2LCBkZXRhY2hfYmV0d2Vlbl9kZXYsIGRldGFjaF9kZXYsIGRpcnR5X2NvbXBvbmVudHMsIGRpc3BhdGNoX2RldiwgZWFjaCwgZWxlbWVudCwgZWxlbWVudF9pcywgZW1wdHksIGVzY2FwZSwgZXNjYXBlZCwgZXhjbHVkZV9pbnRlcm5hbF9wcm9wcywgZml4X2FuZF9kZXN0cm95X2Jsb2NrLCBmaXhfYW5kX291dHJvX2FuZF9kZXN0cm95X2Jsb2NrLCBmaXhfcG9zaXRpb24sIGZsdXNoLCBnZXRDb250ZXh0LCBnZXRfYmluZGluZ19ncm91cF92YWx1ZSwgZ2V0X2N1cnJlbnRfY29tcG9uZW50LCBnZXRfc2xvdF9jaGFuZ2VzLCBnZXRfc2xvdF9jb250ZXh0LCBnZXRfc3ByZWFkX29iamVjdCwgZ2V0X3NwcmVhZF91cGRhdGUsIGdldF9zdG9yZV92YWx1ZSwgZ2xvYmFscywgZ3JvdXBfb3V0cm9zLCBoYW5kbGVfcHJvbWlzZSwgaGFzX3Byb3AsIGlkZW50aXR5LCBpbml0LCBpbnNlcnQsIGluc2VydF9kZXYsIGludHJvcywgaW52YWxpZF9hdHRyaWJ1dGVfbmFtZV9jaGFyYWN0ZXIsIGlzX2NsaWVudCwgaXNfZnVuY3Rpb24sIGlzX3Byb21pc2UsIGxpc3RlbiwgbGlzdGVuX2RldiwgbG9vcCwgbG9vcF9ndWFyZCwgbWlzc2luZ19jb21wb25lbnQsIG1vdW50X2NvbXBvbmVudCwgbm9vcCwgbm90X2VxdWFsLCBub3csIG51bGxfdG9fZW1wdHksIG9iamVjdF93aXRob3V0X3Byb3BlcnRpZXMsIG9uRGVzdHJveSwgb25Nb3VudCwgb25jZSwgb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2ssIHByZXZlbnRfZGVmYXVsdCwgcHJvcF9kZXYsIHF1ZXJ5X3NlbGVjdG9yX2FsbCwgcmFmLCBydW4sIHJ1bl9hbGwsIHNhZmVfbm90X2VxdWFsLCBzY2hlZHVsZV91cGRhdGUsIHNlbGVjdF9tdWx0aXBsZV92YWx1ZSwgc2VsZWN0X29wdGlvbiwgc2VsZWN0X29wdGlvbnMsIHNlbGVjdF92YWx1ZSwgc2VsZiwgc2V0Q29udGV4dCwgc2V0X2F0dHJpYnV0ZXMsIHNldF9jdXJyZW50X2NvbXBvbmVudCwgc2V0X2N1c3RvbV9lbGVtZW50X2RhdGEsIHNldF9kYXRhLCBzZXRfZGF0YV9kZXYsIHNldF9pbnB1dF90eXBlLCBzZXRfaW5wdXRfdmFsdWUsIHNldF9ub3csIHNldF9yYWYsIHNldF9zdG9yZV92YWx1ZSwgc2V0X3N0eWxlLCBzZXRfc3ZnX2F0dHJpYnV0ZXMsIHNwYWNlLCBzcHJlYWQsIHN0b3BfcHJvcGFnYXRpb24sIHN1YnNjcmliZSwgc3ZnX2VsZW1lbnQsIHRleHQsIHRpY2ssIHRpbWVfcmFuZ2VzX3RvX2FycmF5LCB0b19udW1iZXIsIHRvZ2dsZV9jbGFzcywgdHJhbnNpdGlvbl9pbiwgdHJhbnNpdGlvbl9vdXQsIHVwZGF0ZV9rZXllZF9lYWNoLCB2YWxpZGF0ZV9jb21wb25lbnQsIHZhbGlkYXRlX2VhY2hfa2V5cywgdmFsaWRhdGVfc3RvcmUsIHhsaW5rX2F0dHIgfTtcbiIsIjxzY3JpcHQ+XG4gICAgbGV0IGNvbG9yU2VsZWN0VmFsdWUgPSBcInJnYigyNTUsIDI1NSwgMjU1KVwiO1xuICAgIGxldCB0eHRDb2xvclNlbGVjdFZhbHVlID0gXCJyZ2IoMCwgMCwgMClcIjtcblxuICAgIGNvbnN0IGJnQ29sb3JBcnJheSA9IFtdO1xuICAgIGNvbnN0IHR4dENvbG9yQXJyYXkgPSBbXTsgXG5cblxuXG4gICAgbGV0IGNvbG9ycyA9IFtcbiAgICAgICAge3ZhbHVlOiBcInJnYigyNTUsIDI1NSwgMjU1KVwiLCBuYW1lOiBcIndoaXRlXCIsIGRyb3BDb2xvcjogXCJyZ2IoMCwgMCwgMClcIiB9LFxuICAgICAgICB7dmFsdWU6IFwicmdiKDIxMSwgMjExLCAyMTEpXCIsIG5hbWU6IFwibGlnaHQgZ3JleVwiLCBkcm9wQ29sb3I6IFwicmdiKDAsIDAsIDApXCIgfSxcbiAgICAgICAge3ZhbHVlOiBcInJnYigxMjgsIDEyOCwgMTI4KVwiLCBuYW1lOiBcImdyZXlcIiwgZHJvcENvbG9yOiBcInJnYigwLCAwLCAwKVwiIH0sXG4gICAgICAgIHt2YWx1ZTogXCJyZ2IoNDgsIDQ4LCA0OClcIiwgbmFtZTogXCJkYXJrIGdyZXlcIiwgZHJvcENvbG9yOiBcInJnYigyNTUsIDI1NSwgMjU1KVwiIH0sXG4gICAgICAgIHt2YWx1ZTogXCJyZ2IoMCwgMCwgMClcIiwgbmFtZTogXCJibGFja1wiLCBkcm9wQ29sb3I6IFwicmdiKDI1NSwgMjU1LCAyNTUpXCJ9LFxuICAgICAgICB7dmFsdWU6IFwicmdiKDI1NSwgMjU1LCAwKVwiLCBuYW1lOiBcInllbGxvd1wiLCBkcm9wQ29sb3I6IFwicmdiKDAsIDAsIDApXCIgfSxcbiAgICAgICAge3ZhbHVlOiBcInJnYigyNDAsIDIzMCwgMTQwKVwiLCBuYW1lOiBcImtoYWtpXCIsIGRyb3BDb2xvcjogXCJyZ2IoMCwgMCwgMClcIiB9LFxuICAgICAgICB7dmFsdWU6IFwicmdiKDE4OSwgMTgzLCAxMDcpXCIsIG5hbWU6IFwiZGFyayBraGFraVwiLCBkcm9wQ29sb3I6IFwicmdiKDAsIDAsIDApXCIgfSxcbiAgICAgICAge3ZhbHVlOiBcInJnYigyNTUsIDE2NSwgMClcIiwgbmFtZTogXCJvcmFuZ2VcIiwgZHJvcENvbG9yOiBcInJnYigwLCAwLCAwKVwiIH0sXG4gICAgICAgIHt2YWx1ZTogXCJyZ2IoMjU1LCA2OSwgMClcIiwgbmFtZTogXCJvcmFuZ2UgcmVkXCIsIGRyb3BDb2xvcjogXCJyZ2IoMCwgMCwgMClcIiB9LFxuICAgICAgICB7dmFsdWU6IFwicmdiKDI1NSwgMCwgMClcIiwgbmFtZTogXCJyZWRcIiwgZHJvcENvbG9yOiBcInJnYigwLCAwLCAwKVwiIH0sXG4gICAgICAgIHt2YWx1ZTogXCJyZ2IoMTc4LCAzNCwgMzQpXCIsIG5hbWU6IFwiZmlyZSBicmlja1wiLCBkcm9wQ29sb3I6IFwicmdiKDI1NSwgMjU1LCAyNTUpXCIgfSxcbiAgICAgICAge3ZhbHVlOiBcInJnYigyNDAsIDEyOCwgMTI4KVwiLCBuYW1lOiBcImxpZ2h0IGNvcmFsXCIsIGRyb3BDb2xvcjogXCJyZ2IoMCwgMCwgMClcIiB9LFxuICAgICAgICB7dmFsdWU6IFwicmdiKDE0OCwgMCwgMjExKVwiLCBuYW1lOiBcImRhcmsgdmlvbGV0XCIsIGRyb3BDb2xvcjogXCJyZ2IoMCwgMCwgMClcIiB9LFxuICAgICAgICB7dmFsdWU6IFwicmdiKDAsIDAsIDI1NSlcIiwgbmFtZTogXCJibHVlXCIsIGRyb3BDb2xvcjogXCJyZ2IoMjU1LCAyNTUsIDI1NSlcIiB9LFxuICAgICAgICB7dmFsdWU6IFwicmdiKDMwLCAxNDQsIDI1NSlcIiwgbmFtZTogXCJkb2RnZXIgYmx1ZVwiLCBkcm9wQ29sb3I6IFwicmdiKDAsIDAsIDApXCIgfSxcbiAgICAgICAge3ZhbHVlOiBcInJnYigwLCAyNTUsIDEyNylcIiwgbmFtZTogXCJzcHJpbmcgZ3JlZW5cIiwgZHJvcENvbG9yOiBcInJnYigwLCAwLCAwKVwiIH0sXG4gICAgICAgIHt2YWx1ZTogXCJyZ2IoNTAsIDIwNSwgNTApXCIsIG5hbWU6IFwibGltZSBncmVlblwiLCBkcm9wQ29sb3I6IFwicmdiKDAsIDAsIDApXCIgfSxcbiAgICAgICAge3ZhbHVlOiBcInJnYigwLCAxMjgsIDApXCIsIG5hbWU6IFwiZ3JlZW5cIiwgZHJvcENvbG9yOiBcInJnYigwLCAwLCAwKVwiIH1cbiAgICBdXG5cbiAgICBsZXQgZGVzdFNlbGVjdFZhbHVlID0gXCIxXCI7XG4gICAgXG4gICAgZnVuY3Rpb24gc2VsZWN0ZWRSb3coZGVzdFNlbGVjdFZhbHVlKXtcblxuICAgICAgICBsZXQgc2VsZWN0ZWREYXRhUm93ID0gMDtcblxuICAgICAgICBpZiAoZGVzdFNlbGVjdFZhbHVlIDw9IDIpe1xuICAgICAgICAgICAgc2VsZWN0ZWREYXRhUm93ID0gMjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkZXN0U2VsZWN0VmFsdWUgPT09IDMgfHwgZGVzdFNlbGVjdFZhbHVlID09PSA0KXtcbiAgICAgICAgICAgIHNlbGVjdGVkRGF0YVJvdyA9IDM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkRGF0YVJvdztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZWxlY3RlZENvbChkZXN0U2VsZWN0VmFsdWUpe1xuXG4gICAgICAgIGxldCBzZWxlY3RlZERhdGFDb2wgPSAwO1xuXG4gICAgICAgIGlmIChkZXN0U2VsZWN0VmFsdWUgPT09IDEgfHwgZGVzdFNlbGVjdFZhbHVlID09PSAzKXtcbiAgICAgICAgICAgIHNlbGVjdGVkRGF0YUNvbCA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGVzdFNlbGVjdFZhbHVlID09PSAyIHx8IGRlc3RTZWxlY3RWYWx1ZSA9PT0gNCl7XG4gICAgICAgICAgICBzZWxlY3RlZERhdGFDb2wgPSAyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZWxlY3RlZERhdGFDb2w7XG4gICAgfVxuXG4gICAgbGV0IHNlbGVjdFNjb3BlID0gMTtcblxuICAgIGZ1bmN0aW9uIG1hbmlwdWxhdGVBcmVhU2VsZWN0ZWQodGFibGVDZWxsLCByZWNCdXR0b24pe1xuICAgICAgICBpZiAocmVjQnV0dG9uID09PSAxKXtcbiAgICAgICAgICAgIGlmIChzZWxlY3RTY29wZSA9PSAwKXtcbiAgICAgICAgICAgICAgICB0YWJsZUNlbGwuc3R5bGUuYmFja2dyb3VuZCA9IGNvbG9yU2VsZWN0VmFsdWU7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIC8vYWxlcnQodGFibGVDZWxsLnN0eWxlLmNvbG9yKTtcbiAgICAgICAgICAgICAgICB0YWJsZUNlbGwuc3R5bGUuY29sb3IgPSBjb2xvclNlbGVjdFZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHJlY0J1dHRvbiA9PT0gMikge1xuICAgICAgICAgICAgdGFibGVDZWxsLnN0eWxlLmZvbnRTdHlsZSA9IFwiaXRhbGljXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocmVjQnV0dG9uID09PSAzKSB7XG4gICAgICAgICAgICB0YWJsZUNlbGwuc3R5bGUuZm9udFN0eWxlID0gXCJib2xkXCI7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfVxuXG4gICAgLy8gY29uc3QgZnVuYyA9ICgpID0+ICgpID0+IHggKyAxXG5cbiAgICBmdW5jdGlvbiBtYW5pcHVsYXRlU2VsZWN0aW9uKHJlY0J1dHRvbikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGxldCBzZWxlY3RlZERhdGFSb3cgPSAwO1xuICAgICAgICAgICAgbGV0IHNlbGVjdGVkRGF0YUNvbCA9IDA7XG5cbiAgICAgICAgICAgIGRlc3RTZWxlY3RWYWx1ZSA9IHBhcnNlSW50KGRlc3RTZWxlY3RWYWx1ZSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHRhYmxlU2VsZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0clwiKTtcblxuICAgICAgICAgICAgaWYgKGRlc3RTZWxlY3RWYWx1ZSA8PSA0KXtcblxuICAgICAgICAgICAgICAgIHNlbGVjdGVkRGF0YVJvdyA9IHNlbGVjdGVkUm93KGRlc3RTZWxlY3RWYWx1ZSk7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWREYXRhQ29sID0gc2VsZWN0ZWRDb2woZGVzdFNlbGVjdFZhbHVlKTtcblxuICAgICAgICAgICAgICAgIG1hbmlwdWxhdGVBcmVhU2VsZWN0ZWQodGFibGVTZWxlY3Rpb25bc2VsZWN0ZWREYXRhUm93XS5jZWxsc1tzZWxlY3RlZERhdGFDb2xdLCByZWNCdXR0b24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZGVzdFNlbGVjdFZhbHVlID09PSA1KXtcblxuICAgICAgICAgICAgICAgIC8vdGFibGVTZWxlY3Rpb25bMl0uY2VsbHNbMV0uc3R5bGUuYmFja2dyb3VuZCA9IGNvbG9yU2VsZWN0VmFsdWU7XG4gICAgICAgICAgICAgICAgbWFuaXB1bGF0ZUFyZWFTZWxlY3RlZCh0YWJsZVNlbGVjdGlvblsyXS5jZWxsc1sxXSwgcmVjQnV0dG9uKTtcbiAgICAgICAgICAgICAgICBtYW5pcHVsYXRlQXJlYVNlbGVjdGVkKHRhYmxlU2VsZWN0aW9uWzJdLmNlbGxzWzJdLCByZWNCdXR0b24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZGVzdFNlbGVjdFZhbHVlID09PSA2KXtcbiAgICAgICAgICAgICAgICBtYW5pcHVsYXRlQXJlYVNlbGVjdGVkKHRhYmxlU2VsZWN0aW9uWzNdLmNlbGxzWzFdLCByZWNCdXR0b24pO1xuICAgICAgICAgICAgICAgIG1hbmlwdWxhdGVBcmVhU2VsZWN0ZWQodGFibGVTZWxlY3Rpb25bM10uY2VsbHNbMl0sIHJlY0J1dHRvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChkZXN0U2VsZWN0VmFsdWUgPT09IDcpe1xuICAgICAgICAgICAgICAgIG1hbmlwdWxhdGVBcmVhU2VsZWN0ZWQodGFibGVTZWxlY3Rpb25bMl0uY2VsbHNbMV0sIHJlY0J1dHRvbik7XG4gICAgICAgICAgICAgICAgbWFuaXB1bGF0ZUFyZWFTZWxlY3RlZCh0YWJsZVNlbGVjdGlvblszXS5jZWxsc1sxXSwgcmVjQnV0dG9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGRlc3RTZWxlY3RWYWx1ZSA9PT0gOCl7XG4gICAgICAgICAgICAgICAgbWFuaXB1bGF0ZUFyZWFTZWxlY3RlZCh0YWJsZVNlbGVjdGlvblsyXS5jZWxsc1syXSwgcmVjQnV0dG9uKTtcbiAgICAgICAgICAgICAgICBtYW5pcHVsYXRlQXJlYVNlbGVjdGVkKHRhYmxlU2VsZWN0aW9uWzNdLmNlbGxzWzJdLCByZWNCdXR0b24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbWFuaXB1bGF0ZUFyZWFTZWxlY3RlZCh0YWJsZVNlbGVjdGlvblsyXS5jZWxsc1sxXSwgcmVjQnV0dG9uKTtcbiAgICAgICAgICAgICAgICBtYW5pcHVsYXRlQXJlYVNlbGVjdGVkKHRhYmxlU2VsZWN0aW9uWzJdLmNlbGxzWzJdLCByZWNCdXR0b24pO1xuICAgICAgICAgICAgICAgIG1hbmlwdWxhdGVBcmVhU2VsZWN0ZWQodGFibGVTZWxlY3Rpb25bM10uY2VsbHNbMV0sIHJlY0J1dHRvbik7XG4gICAgICAgICAgICAgICAgbWFuaXB1bGF0ZUFyZWFTZWxlY3RlZCh0YWJsZVNlbGVjdGlvblszXS5jZWxsc1syXSwgcmVjQnV0dG9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vY29uc3QgdGFibGVEaW0gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwic2FwRXBtVWlDb250cm9sQ3Jvc3N0YWJUYWJsZUlubmVyXCIpXG4gICAgXG4gICAgXG4gICAgLy9sZXQgdGFibGVTY29wZSA9IHtyb3c6MCwgY29sOjB9OyBcbiAgICBmdW5jdGlvbiBzcGVjaWZ5VGFibGVSb3coZXZlbnQpIHtcblxuICAgICAgICBjb25zdCB0YWJsZUNvbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwic2FwRXBtVWlDb250cm9sQ3Jvc3N0YWJUYWJsZUlubmVyXCIpWzBdO1xuICAgICAgICBjb25zdCBwb3dkZXJCbHVlID0gXCIjQjBFMEU2XCI7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YWJsZUNvbnQucm93cy5sZW5ndGg7IGkrKyl7XG5cbiAgICAgICAgICAgIGJnQ29sb3JBcnJheS5wdXNoKFtdKTtcbiAgICAgICAgICAgIHR4dENvbG9yQXJyYXkucHVzaChbXSk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGFibGVDb250LnJvd3NbaV0uY2VsbHMubGVuZ3RoOyBqKyspe1xuICAgICAgICAgICAgICAgIC8vaWYgKGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0cicpICE9IG51bGwgJiYgZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ3RyJykuZGF0YXNldC5yb3cgPT0gaSAmJiBldmVudC50YXJnZXQuY2xvc2VzdCgndGQnKSAhPSBudWxsICYmIGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0ZCcpLmRhdGFzZXQuY29sID09IGopXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0cicpICE9IG51bGwgJiYgZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ3RyJykuZGF0YXNldC5yb3cgPT0gaSAmJiBldmVudC50YXJnZXQuY2xvc2VzdCgndGQnKSAhPSBudWxsICYmIGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0ZCcpLmRhdGFzZXQuY29sID09IGope1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgYmdDb2xvckFycmF5W2ldW2pdID0gdGFibGVDb250LnJvd3NbaV0uY2VsbHNbal0uc3R5bGUuYmFja2dyb3VuZDtcbiAgICAgICAgICAgICAgICAgICAgdHh0Q29sb3JBcnJheVtpXVtqXSA9IHRhYmxlQ29udC5yb3dzW2ldLmNlbGxzW2pdLnN0eWxlLmNvbG9yO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vdGFibGVDb250LnJvd3NbaV0uY2VsbHNbal0uc3R5bGUuYmFja2dyb3VuZCA9IFwiI0IwRTBFNlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFibGVDb250LnJvd3NbaV0uY2VsbHNbal0uc3R5bGUuYmFja2dyb3VuZCAhPSBcInJnYigxNzYsIDIyNCwgMjMwKVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ29udC5yb3dzW2ldLmNlbGxzW2pdLnN0eWxlLmJhY2tncm91bmQgPSBcInJnYigxNzYsIDIyNCwgMjMwKVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUNvbnQucm93c1tpXS5jZWxsc1tqXS5zdHlsZS5iYWNrZ3JvdW5kID0gY29sb3JTZWxlY3RWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNoYW5nZUJhY2tnck9mTWFya2VkKCl7XG4gICAgICAgIGNvbnN0IHRhYmxlQ29udCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJzYXBFcG1VaUNvbnRyb2xDcm9zc3RhYlRhYmxlSW5uZXJcIilbMF07XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YWJsZUNvbnQucm93cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRhYmxlQ29udC5yb3dzW2ldLmNlbGxzLmxlbmd0aDsgaisrKXtcbiAgICAgICAgICAgICAgICAvL2lmIChldmVudC50YXJnZXQuY2xvc2VzdCgndHInKSAhPSBudWxsICYmIGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0cicpLmRhdGFzZXQucm93ID09IGkgJiYgZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ3RkJykgIT0gbnVsbCAmJiBldmVudC50YXJnZXQuY2xvc2VzdCgndGQnKS5kYXRhc2V0LmNvbCA9PSBqKVxuICAgICAgICAgICAgICAgIGlmICh0YWJsZUNvbnQucm93c1tpXS5jZWxsc1tqXS5zdHlsZS5iYWNrZ3JvdW5kID09IFwicmdiKDE3NiwgMjI0LCAyMzApXCIpe1xuICAgICAgICAgICAgICAgICAgICB0YWJsZUNvbnQucm93c1tpXS5jZWxsc1tqXS5zdHlsZS5iYWNrZ3JvdW5kID0gY29sb3JTZWxlY3RWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjaGFuZ2VUZXh0Q29sb3JPZk1hcmtlZCgpe1xuICAgICAgICBjb25zdCB0YWJsZUNvbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwic2FwRXBtVWlDb250cm9sQ3Jvc3N0YWJUYWJsZUlubmVyXCIpWzBdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRhYmxlQ29udC5yb3dzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGFibGVDb250LnJvd3NbaV0uY2VsbHMubGVuZ3RoOyBqKyspe1xuICAgICAgICAgICAgICAgIC8vaWYgKGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0cicpICE9IG51bGwgJiYgZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ3RyJykuZGF0YXNldC5yb3cgPT0gaSAmJiBldmVudC50YXJnZXQuY2xvc2VzdCgndGQnKSAhPSBudWxsICYmIGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0ZCcpLmRhdGFzZXQuY29sID09IGopXG4gICAgICAgICAgICAgICAgaWYgKHRhYmxlQ29udC5yb3dzW2ldLmNlbGxzW2pdLnN0eWxlLmJhY2tncm91bmQgPT0gXCJyZ2IoMTc2LCAyMjQsIDIzMClcIil7XG4gICAgICAgICAgICAgICAgICAgIHRhYmxlQ29udC5yb3dzW2ldLmNlbGxzW2pdLnN0eWxlLmNvbG9yID0gdHh0Q29sb3JTZWxlY3RWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGFibGVDb250LnJvd3NbaV0uY2VsbHNbal0uc3R5bGUuYmFja2dyb3VuZCA9IGJnQ29sb3JBcnJheVtpXVtqXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRleHRXZWlnaHRUcmlnZ2VyKGNlbGxGb250U3R5bGUsdHJpZ2dlcil7XG5cbiAgICAgICAgaWYgKGNlbGxGb250U3R5bGUuZm9udFN0eWxlICE9IFwiaXRhbGljXCIgJiYgdHJpZ2dlciA9PSAxKXtcbiAgICAgICAgICAgIHJldHVybiBcIml0YWxpY1wiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNlbGxGb250U3R5bGUuZm9udFN0eWxlID09IFwiaXRhbGljXCIgJiYgdHJpZ2dlciA9PSAxKXtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNlbGxGb250U3R5bGUuZm9udFdlaWdodCAhPSBcImJvbGRcIiAmJiB0cmlnZ2VyID09IDIpe1xuICAgICAgICAgICAgcmV0dXJuIFwiYm9sZFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICByZXR1cm4gXCJub3JtYWxcIjtcbiAgICAgICAgfVxuICAgIH0gXG5cbiAgICBmdW5jdGlvbiBjaGFuZ2VUZXh0V2VpZ2h0T2ZNYXJrZWQodHJpZ2dlcil7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBJbm5lckNoYW5nZVRleHRXZWlnaHRPZk1hcmtlZCgpe1xuICAgICAgICAgICAgY29uc3QgdGFibGVDb250ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInNhcEVwbVVpQ29udHJvbENyb3NzdGFiVGFibGVJbm5lclwiKVswXTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFibGVDb250LnJvd3MubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGFibGVDb250LnJvd3NbaV0uY2VsbHMubGVuZ3RoOyBqKyspe1xuICAgICAgICAgICAgICAgICAgICAvL2lmIChldmVudC50YXJnZXQuY2xvc2VzdCgndHInKSAhPSBudWxsICYmIGV2ZW50LnRhcmdldC5jbG9zZXN0KCd0cicpLmRhdGFzZXQucm93ID09IGkgJiYgZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ3RkJykgIT0gbnVsbCAmJiBldmVudC50YXJnZXQuY2xvc2VzdCgndGQnKS5kYXRhc2V0LmNvbCA9PSBqKVxuICAgICAgICAgICAgICAgICAgICBpZiAodGFibGVDb250LnJvd3NbaV0uY2VsbHNbal0uc3R5bGUuYmFja2dyb3VuZCA9PSBcInJnYigxNzYsIDIyNCwgMjMwKVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ29udC5yb3dzW2ldLmNlbGxzW2pdLnN0eWxlLmZvbnRTdHlsZSA9IHRleHRXZWlnaHRUcmlnZ2VyKHRhYmxlQ29udC5yb3dzW2ldLmNlbGxzW2pdLnN0eWxlLCB0cmlnZ2VyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0YWJsZUNvbnQucm93c1tpXS5jZWxsc1tqXS5zdHlsZS5iYWNrZ3JvdW5kID0gYmdDb2xvckFycmF5W2ldW2pdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vdmFyIHRhYmxlQ29udCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJzYXBFcG1VaUNvbnRyb2xDcm9zc3RhYlRhYmxlSW5uZXJcIik7XG4gICAgLy92YXIgeCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJzYXBFcG1VaUNvbnRyb2xDcm9zc3RhYlRhYmxlSW5uZXJcIilbMF0ubGVuZ3RoO1xuICAgIFxuICAgIGxldCBtUG9zID0geyB4OjAsIHk6MH07XG4gICAgZnVuY3Rpb24gaGFuZGxlTW91c2VDbGljayhldmVudCl7XG4gICAgICAgIG1Qb3MueCA9IGV2ZW50LmNsaWVudFg7XG4gICAgICAgIG1Qb3MueSA9IGV2ZW50LmNsaWVudFk7XG5cbiAgICAgICAgc3BlY2lmeVRhYmxlUm93KGV2ZW50KTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gcm93U2VsZWN0KCl7XG4gICAgICAgIFxuICAgIH1cblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVNb3VzZUNsaWNrKTsgIFxuXG48L3NjcmlwdD5cblxuPGRpdiBvbjpjbGljaz17aGFuZGxlTW91c2VDbGlja30+XG5DbGlja2VkIGF0IHttUG9zLnh9IHgge21Qb3MueX0uXG5cbjxzZWxlY3QgYmluZDp2YWx1ZT1cIntkZXN0U2VsZWN0VmFsdWV9XCI+IFxuICAgIDxvcHRpb24gdmFsdWU9XCIxXCI+cm93IDEgLyBjb2wuIDE8L29wdGlvbj5cbiAgICA8b3B0aW9uIHZhbHVlPVwiMlwiPnJvdyAxIC8gY29sLiAyPC9vcHRpb24+XG4gICAgPG9wdGlvbiB2YWx1ZT1cIjNcIj5yb3cgMiAvIGNvbC4gMTwvb3B0aW9uPlxuICAgIDxvcHRpb24gdmFsdWU9XCI0XCI+cm93IDIgLyBjb2wuIDI8L29wdGlvbj5cbiAgICA8b3B0aW9uIHZhbHVlPVwiNVwiPnVwcGVyIHJvdzwvb3B0aW9uPlxuICAgIDxvcHRpb24gdmFsdWU9XCI2XCI+bG93ZXIgcm93PC9vcHRpb24+XG4gICAgPG9wdGlvbiB2YWx1ZT1cIjdcIj5sZWZ0IGNvbHVtbjwvb3B0aW9uPlxuICAgIDxvcHRpb24gdmFsdWU9XCI4XCI+cmlnaHQgY29sdW1uPC9vcHRpb24+XG4gICAgPG9wdGlvbiB2YWx1ZT1cIjlcIj5jb21wbGV0ZSBjaGFydDwvb3B0aW9uPlxuPC9zZWxlY3Q+XG5cbjxzZWxlY3QgYmluZDp2YWx1ZT1cIntjb2xvclNlbGVjdFZhbHVlfVwiPlxuICAgICAgICB7I2VhY2ggY29sb3JzIGFzIGNvbG9yfVxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIntjb2xvci52YWx1ZX1cIiBzdHlsZT1cImJhY2tncm91bmQ6e2NvbG9yLnZhbHVlfTtjb2xvcjp7Y29sb3IuZHJvcENvbG9yfTtcIj57Y29sb3IubmFtZX08L29wdGlvbj5cbiAgICAgICAgey9lYWNofVxuPC9zZWxlY3Q+XG5cbjxzZWxlY3QgYmluZDp2YWx1ZT1cInt0eHRDb2xvclNlbGVjdFZhbHVlfVwiPlxuICAgICAgICB7I2VhY2ggY29sb3JzIGFzIGNvbG9yfVxuICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIntjb2xvci52YWx1ZX1cIiBzdHlsZT1cImJhY2tncm91bmQ6e2NvbG9yLnZhbHVlfTtjb2xvcjp7Y29sb3IuZHJvcENvbG9yfTtcIj57Y29sb3IubmFtZX08L29wdGlvbj5cbiAgICAgICAgey9lYWNofVxuPC9zZWxlY3Q+XG5cbjxkaXY+XG48cD5Nb2RpZnkgY29sb3Igb2Y8L3A+XG48bGFiZWw+XG48aW5wdXQgdHlwZT1yYWRpbyBuYW1lPVwic2NvcGVTZWxlY3RcIiBiaW5kOmdyb3VwPXtzZWxlY3RTY29wZX0gdmFsdWU9ezB9IGNoZWNrZWQ9XCJjaGVja2VkXCI+XG5cdGJhY2tncm91bmRcbjwvbGFiZWw+XG5cbjxsYWJlbD5cbjxpbnB1dCB0eXBlPXJhZGlvIG5hbWU9XCJzY29wZVNlbGVjdFwiIGJpbmQ6Z3JvdXA9e3NlbGVjdFNjb3BlfSB2YWx1ZT17MX0+XG5cdHRleHRcbjwvbGFiZWw+XG5cbjwvZGl2PlxuXG48YnV0dG9uIG9uOmNsaWNrPXtjaGFuZ2VCYWNrZ3JPZk1hcmtlZH0+Q2hhbmdlIGJhY2tncm91bmQ8L2J1dHRvbj5cbjxidXR0b24gb246Y2xpY2s9e2NoYW5nZVRleHRDb2xvck9mTWFya2VkfT5DaGFuZ2UgdGV4dCBjb2xvcjwvYnV0dG9uPlxuPGJ1dHRvbiBvbjpjbGljaz17Y2hhbmdlVGV4dFdlaWdodE9mTWFya2VkKDEpfT5JPC9idXR0b24+XG48YnV0dG9uIG9uOmNsaWNrPXtjaGFuZ2VUZXh0V2VpZ2h0T2ZNYXJrZWQoMil9PkI8L2J1dHRvbj5cblxuPC9kaXY+Il0sInNvdXJjZVJvb3QiOiIifQ==